<!DOCTYPE html>
<html>
  <head>
    <!-- Google Automatic Advertising -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4525414114581084"
     crossorigin="anonymous"></script>

<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">

<meta name="google-site-verification" content="4cR7WuQWEtkbu8ThfxGkT1vACiVi5Q_8ykfkRudOnTU" />

<link rel="shortcut icon" href="/images/logo.png">
<link rel="stylesheet" type="text/css" href="/css/common.css"><script type="text/javascript" src="/js/jquery-1.9.0.min.js"></script>
<script type="text/javascript" src="/js/google-code-prettify/prettify.js"></script>
<link  type="text/css" rel="stylesheet" href="/js/google-code-prettify/prettify.css"/>
<script>
  $(function(){
    $("pre").addClass("prettyprint");
    function init(event){
      prettyPrint();
    }
    if(window.addEventListener)window.addEventListener("load",init,false);
    else if(window.attachEvent)window.attachEvent("onload",init);
    
    $(".to-top").click(function() {
      $('body, html').animate({scrollTop: 0}, 300, 'linear');;
    });
  });
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HVBGQBWKJ2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HVBGQBWKJ2');
</script>

  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="header_main">
  <h1><a href="/"><img src="/images/logo.png">Perl ABC</a></h1>
</div>

      </div>
      <div class="main">
        <div class="content">
          <div class="entry">
  <div class="top">
    
  </div>
  <div class="middle">
    <div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2022/04/26</div>
<h2><a href="/blog/20220426170406.html">Installing Strawberry Perl using Chocolatey</a></h2>
<p>
  If you use <a href="https://docs.chocolatey.org/en-us/">Chocolatey</a>, you can install <a href="/blog/20180808153368.html">Strawberry Perl</a> from <a href="https://en.wikipedia.org/wiki/Command-line_interface">CLI</a>.
</p>
<h3>Installing Chocolatey</h3>
<p>
  Let's install Chocolatey. Chocolatey is a CLI tool to manage applications on Windows.
</p>
<p>
  See also official <a href="https://docs.chocolatey.org/en-us/choco/setup">SETUP / INSTALL of Chocolatey</a>.
</p>
<h4>Command Prompt</h4>
<p>
  Install Chocolatey using <a href="/blog/20080603121251.html">Command Prompt</a>.
</p>
<pre>
@"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "[System.Net.ServicePointManager]::SecurityProtocol = 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))" &amp;&amp; SET "PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin"
</pre>
<h4>PowerShell</h4>
<p>
  Install Chocolatey using <a href="/blog/20220420170117.html">PowerShell</a>.
</p>
<pre>
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
</pre>
<h3>Installing Strawberry Perl using Chocolatey</h3>
<p>
  Install Strawberry Perl using Chocolatey.
</p>
<pre>
choco install strawberryperl
</pre>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2022/04/20</div>
<h2><a href="/blog/20220420170117.html">PowerShell(pwsh) Tutorial for Perl</a></h2>
<ol class = "bread" itemscope itemtype = "http://schema.org/BreadcrumbList">  <li itemprop = "itemListElement" itemscope itemtype = "http://schema.org/ListItem">    <a itemprop="item" href="/">        <span itemprop = "name">Perl </span></a>
    <meta itemprop = "position" content = "1" />
  </li>
  &#8250;
  <li itemprop = "itemListElement" itemscope itemtype = "http://schema.org/ListItem">      <span itemprop = "name">here </span>
    <meta itemprop = "position" content = "2" />
  </li>
</ol>
<p>
  PowerShell(pwsh) is a <a href="https://en.wikipedia.org/wiki/Command-line_interface">CLI</a> tool to run programs on Windows. 
</p>
<h3>Features of PowerShell(pwsh)</h3>
<ul>
  <li>UTF-8</li>
  <li>Linux/UNIX-like Shell</li>
  <li>ls, echo commands, etc</li>
  <li>A string is quoted "" and ''</li>
</ul>
<h3>Installation of PowerShell(pwsh)</h3>
<p>
  PowerShell(pwsh) can be downloaded from the following page.
</p>
<p>
  <a href="https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7#installing-the-msi-package">Installing PowerShell on Windows</a>
</p>
<p>
  Click the following link to download PowerShell(pwsh).
</p>
<p>
  <a href="https://github.com/PowerShell/PowerShell/releases/download/v7.2.2/PowerShell-7.2.2-win-x64.msi"!>PowerShell-7.2.2-win-x64.msi</a>
</p>
<p>
  And double-click the downloaded file. The installer is executed.
</p>
<p>
  "Next" | "Next" | "Next" | "Install" | "Finish"
</p>
<h3>Execution of PowerShell/pwsh</h3>
<p>
  Let's execute PowerShell/pwsh.
</p>
<p>
  "Start Menu" | "Apps" | "PowerShell" | "PowerShell 7 (x64)"
</p>
<p>
  <img src="/images/installation/pwsh.png">
</p>
<p>
  Your home directory is shown on PowerShell/pwsh.
</p>
<pre>
PS C:\Users\kimot
</pre>
<h3>Showing File Extensions</h3>
<p>
  The extension of Perl program is "<b>.pl</b>". It is useful if extensions of files are displayed.
</p>
<p>
  The way to show file extensions is described in the following page.
</p>
<p>
  <a href="https://www.howtogeek.com/205086/beginner-how-to-make-windows-show-file-extensions/">How to Make Windows Show File Extensions</a>
</p>
<h3>Execution of Notepad</h3>
<p>
  Perl programs are text files. You can create your Perl programs using Notepad.
</p>
<p>
  The way to use Notepad is described in the following page.
</p>
<p>
  <a href="https://www.digitalcitizen.life/start-notepad-windows/">11 ways to start Notepad in Windows</a>
</p>
<h3>Creating Perl Programs</h3>
<p>
  Let's create a Perl program.
</p>
<p>
  Create a file named "start.pl" at your home directory.
</p>
<pre>
C:\Users\kimot\start.pl
</pre>
<p>
  And write the following text.
</p>
<pre>
print "Hello World";
</pre>
<p>
  And save it.
</p>
<h3>Running Perl Programs</h3>
<p>
  You can run your Perl program using <b>perl</b> command.
</p>
<pre>
perl start.pl
</pre>
<p>
  The output is:
</p>
<pre>
Hello World
</pre>
<h3>Commands of PowerShell/pwsh</h3>
<p>
  Introdule often used commands of PowerShell/pwsh.
</p>
<h4>ls</h4>
<p>
  The "ls" command displays the list of files.
</p>
<pre>
ls
</pre>
<h4>cd</h4>
<p>
  The "cd" command changes the working directory.
</p>
<pre>
cd DirectoryName
</pre>
<p>
  ".." is the file name that means the folder one level higher.
</p>
<pre>
cd ..
</pre>
<h4>Changing Drives</h4>
<p>
  You can change drives using "c:" or "d:".
</p>
<pre>
Set-Location -Path c:
Set-Location -Path d:
</pre>
<h4>Seeing Command Histories</h4>
<p>
  You can see command histories using "↑" and "↓" keys.
</p>
<pre>
↑
↓
</pre>
<h3>Show Environment Variables</h3>
<p>
  Show environment variables.
</p>
<pre>
ls env:
</pre>
<h4>Getting Environment Variables</h4>
<p>
  You can get and show an environment variable as the following.
</p>
<pre>
echo $env:PATH
</pre>
<p>
  $env:MYENV = "This is my env."
</p>
<h4>Setting Environment Variable</h4>
<p>
  You can set an environment variable as the following.
</p>
<pre>
$env:DATE=20080604
</pre>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2022/04/18</div>
<h2><a href="/blog/20220418170733.html">Installing Perl on WSL 2</a></h2>
<p>
  <a href="https://docs.microsoft.com/en-us/windows/wsl/install">WSL 2</a> is Windows Subsystem for Linux. You can install Linux on Windows using WSL 2. And you can use Perl.
</p>
<p>
  <img style = "border: 1px solid # ddd; max-width: 600px;" src = "/images/installation/wsl2.png">
</p>
<h3>Installing WSL 2</h3>
<p>
  Let's intall WSL 2. Run the following command on <a href="/blog/20080603121251.html">Windows Command Prompt</a>.
</p>
<pre>
# Install WSL 2
wsl --install
</pre>
<p>
  <a href="https://en.ubuntu.perlzemi.com/">Ubuntu</a> is installed by default.
</p>
<p>
  Reboot Windows to enable WSL2.
</p>
<p>
  Take a few minutes.
</p>
<p>
  You see the following messages.
</p>
<h4>User Name</h4>
<pre>
Installing, this may take a few minutes...

Please create a default UNIX user account. The username does not need to match your Windows username.
For more information visit: https://aka.ms/wslusers
Enter new UNIX username:
</pre>
<p>
  I enter the following user name as an example.
</p>
<pre>
kimoto_ubuntu
</pre>
<p>
  By right-clicking on Ubuntu terminal, you can paste the user name.
</p>
<h4>Password</h4>
<p>
  Next, set password.
</p>
<p>
  The setup of Ubuntu is completed.
</p>
<h3>Boot Ubuntu</h3>
<p>
  Let's boot Ubuntu.
</p>
<p>
  "Start Menu" | "Ubuntu"
</p>
<h3>Checking the installation of Perl</h3>
<p>
  Perl is installed by default on Ubuntu. Let's check the installation of Perl.
</p>
<pre>
perl -v
</pre>
<p>
  The version of Perl is displayed.
</p>
<pre>
This is perl 5, version 30, subversion 0 (v5.30.0) built for x86_64-linux-gnu-thread-multi
</pre>
<h3>Show files using Explore</h3>
<p>
  You can see files on Ubuntu by the following path. <b>\\wsl$</b> is root directory of WSL 2.
</p>
<pre>
\\wsl$\Ubuntu\home\kimoto_ubuntu
</pre>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2022/01/14</div>
<h2><a href="/blog/20220114172658.html">How to create the Cover of Amazon Kindle Paperback using Perl?</a></h2>
<p>
  Describe how to create the Cover of Amazon Kindle Paperback using Perl? Perl is a programing language. You can create the the cover image of Amazon Kindle Paperback using Perl module <a href="https://metacpan.org/pod/Imager">Imager</a>.
</p>
<p>
  I assume you have an ebook cover. Based on this, you will create the paperback cover. In this example, I use A5(148 x 210 mm).
</p>
<p>
  <img src="/images/kindle_paperback/ebook_coloer.jpg" style="width:200px">
</p>
<h3>Create a Paperback Cover - Amazon Kindle Officail</h3>
<p>
  At first, you see the Amazon Kindle Officail page "Create a Paperback Cover".
</p>
<ul>
  <li><a href="https://kdp.amazon.com/en_US/help/topic/G201953020">Create a Paperback Cover</a></li>
</ul>
<p>
  You will find the following page "Print Cover Calculator and Templates".
</p>
<ul>
  <li><a href="https://kdp.amazon.com/cover-calculator">Create a Paperback Cover</a></li>
</ul>
<p>
  You must calcurate the size of the cover image using the tool "Print Cover Calculator and Templates".
</p>
<h3>Enter Your Book Information</h3>
<p>
  <b>Binding type</b>
</p>
<p>
  Paperback
</p>
<p>
  <b>Interior type</b>
</p>
<p>
  Choice the one of them you want.
</p>
<ul>
  <li>
    Black & White
  </li>
  <li>
    Premiam Color
  </li>
  <li>
    Standard Color
  </li>
</ul>
<p>
  <b>Paper type</b>
</p>
<p>
  White paper
</p>
<p>
  <b>Page-turn direction</b>
</p>
<p>
  Choice the one of them you want.
</p>
<ul>
  <li>
    Left to Right
  </li>
  <li>
    Right to Left
  </li>
</ul>
<p>
  <b>Measurement units</b>
</p>
<p>
  Millimeters.
</p>
<p>
  <b>Interior trim size</b>
</p>
<p>
  Custom trim size. In this example, A5(148mm x 210 mm) size.
</p>
<p>
  148mm 210mm
</p>
<p>
  <b>Page count</b>
</p>
<p>
  Calcurate the page count of your book.
</p>
<pre>
page_count = body_page_count + cover_page_count.
</pre>
<p>
  body_page_count is the page count of your PDF book.
</p>
<p>
  cover_page_count is the page count of the color. This is always 4p.
</p>
<pre>
# Example:
120p = 116p + 4p
</pre>
<p>
  (Uncompeted)
</p>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2021/11/19</div>
<h2><a href="/blog/20211119124656.html">JavaScript Supported Web Scraping using Perl and Selenium</a></h2>
<p>
  I explain JavaScript supported web scraping using Perl and <a href="https://metacpan.org/pod/Selenium::Remote::Driver">Selenium::Remote::Driver</a>. Selenium::Remote::Driver is a Perl module for Selenium. Selenium provides the APIs for JavaScript supported web scraping. 
</p>
<h3>Download and Install Perl</h3>
<p>
  See the following articles about how to donwload and install Perl. Windows, Max, Linux/UNIX are supported.
</p>
<ul>
  <li><a href="/blog/20180820153471.html">Download and Install Perl</a></li>
</ul>
<h3>Download and Install Google Chrome</h3>
<p>
  I explain the way to install web browsers.
</p>
<h4>Windows and Mac</h4>
<p>
  You can download and install Google Chrome in the following page.
</p>
<ul>
 <li><a href="https://www.google.com/chrome/">Google Chrome - Download</a></li>
</ul>
<h4>Linux</h4>
<p>
  In Linux you maybe install Google Chrome using package managers. I try the installing Google Chrome on the some Linux distributions.
</p>
<h5>Ubuntu</h5>
<ul>
 <li><a href="https://en.ubuntu.perlzemi.com/blog/20211117083934.html">Install Google Chrome on Ubuntu</a></li>
</ul>
<h5>CentOS</h5>
<ul>
 <li><a href="https://en.centos.perlzemi.com/blog/20210104090837.html">Install Google Chrome on CentOS</a></li>
</ul>
<h4>Check the version of Google Chrome</h4>
<p>
  Check the version of Google Chrome.
</p>
<pre>
google-chrome --version
</pre>
<p>
  An example of the output:
</p>
<pre>
Google Chrome 87.0.4280.88
</pre>
<h3>Download and Install ChromeDriver</h3>
<p>
  ChromeDriver is a web driver. Web drivers is tools to control Web browsers by using programs.
</p>
<h5>Ubuntu</h5>
<ul>
 <li><a href="https://en.ubuntu.perlzemi.com/blog/20211116083934.html">Install ChromeDriver on Ubuntu</a></li>
</ul>
<h5>CentOS</h5>
<ul>
 <li><a href="https://en.centos.perlzemi.com/blog/20210103090837.html">Install ChromeDriver on CentOS</a></li>
</ul>
<h4>Check the version of ChromeDriver</h4>
<p>
  Check the version of ChromeDriver.
</p>
<pre>
chromedriver --version
</pre>
<p>
  An example of the output:
</p>
<pre>
ChromeDriver 87.0.4280.88 (89e2380a3e36c3464b5dd1302349b1382549290d-refs/branch-heads/4280@{#1761})
</pre>
<p>
  It is good that the version of ChromeDriver is the same as Google Chrome to prevent problems.
</p>
<h3>Install Selenium::Remote::Driver</h3>
<p>
  Let's install <a href="https://metacpan.org/pod/Selenium::Remote::Driver">Selenium::Remote::Driver</a> using <a href="/blog/20101027127859.html">cpanm</a> or <a href="/blog/20100504127089.html">cpan</a>. Selenium::Remote::Driver is a Perl module for Selenium.
</p>
<pre>
# cpanm
cpanm Selenium::Remote::Driver

# cpan
cpan Selenium::Remote::Driver
</pre>
<h3>Get a Web Page using Selenium</h3>
<p>
  Get a Web Page using Selenium.
</p>
<h4>Load Selenium::Chrome</h4>
<p>
  Let's load <b>Selenium::Chrome</b>. Selenium::Chrome is a sub class of Selenium::Remote::Driver for Google Chrome.
</p>
<pre>
use Selenium::Chrome;
</pre>
<h4>Create a Selenium::Chrome Object</h4>
<p>
  Create a Selenium::Chrome object with headless options. 
</p>
<pre>
my $driver = Selenium::Chrome-&gt;new(
  extra_capabilities =&gt; {
    'goog:chromeOptions' =&gt; {
      args =&gt; ['headless', 'disable-gpu', 'window-size=1920,1080', 'no-sandbox' ]
    }
  }
);
</pre>
<p>
  <b>new</b> method is a constructor of normal <a href="https://en.perlzemi.com/blog/20161030147778.html">Perl Objcet Oriented Programing</a>. Options is specified using <a href="https://en.perlzemi.com/blog/20180208151809.html">Hash References</a> and <a href="https://en.perlzemi.com/blog/20180214151861.html">Array References</a>
</p>
<p>
  These options is needed for headless execution. Headless execution means you get a page without the GUI of Google Chrome.
</p>
<p>
  If there are no these options and you don't have GUI display, you will see the following error message.
</p>
<pre>
Could not create new session: unknown error: Chrome failed to start: exited abnormally.

(unknown error: DevToolsActivePort file doesn't exist) (The process started from chrome location /usr/bin/google-chrome is no longer running, so ChromeDriver is assuming that Chrome has crashed.) at access.pl line 79.
</pre>
<h4>Shutdown a Selenium::Chrome Object</h4>
<p>
  If you finish the use of Selenium::Chrome, you need to shutdown it.
</p>
<pre>
$driver-&gt;shutdown_binary;
</pre>
<h4>Get a Web Page and the Title</h4>
<p>
  You can get a web page using a <b>get</b> method.
</p>
<pre>
$driver-&gt;get('http://www.google.com');
</pre>
<p>
  It is good to wait for a few seconds because the page is maybe not yet rendered.
</p>
<pre>
sleep 3;
</pre>
<p>
  You can get the title using a <b>get_title</b> method.
</p>
<pre>
my $title = $driver-&gt;get_title;
</pre>
<p>
  <b>Examples:</b>
</p>
<p>
  This is an example to get a page and the title.
</p>
<pre>
use Selenium::Chrome;

# Create a Selenium::Chrome object
my $driver = Selenium::Chrome-&gt;new(
  extra_capabilities =&gt; {
    'goog:chromeOptions' =&gt; {
      args =&gt; ['headless', 'disable-gpu', 'window-size=1920,1080', 'no-sandbox' ]
    }
  }
);

# Get a page
$driver-&gt;get('http://www.google.com');

sleep 3;

# Get the title
my $title = $driver-&gt;get_title;

print "$title\n";

# Shutdown
$driver-&gt;shutdown_binary;
</pre>
<p>
  The output:
</p>
<pre>
Google
</pre>
<h4>Get the Screenshot</h4>
<p>
  You can get the screenshot using <b>capture_screenshot</b> method.
</p>
<pre>
$driver-&gt;capture_screenshot("screenshot.png");
</pre>
<p>
  If you want to save the screenshot to the program directory, you can use <a href="/blog/20100524127696.html">FindBin</a> module.
</p>
<pre>
use FindBin;

$driver-&gt;capture_screenshot("$FindBin::Bin/screenshot.png");
</pre>
<p>
  If you want to serve the screenshot file and see it on your web browser, you can use <a href="https://metacpan.org/pod/Mojolicious::Plugin::Directory">Mojolicious::Plugin::Directory</a> or <a href="https://metacpan.org/pod/Mojolicious::Plugin::Directory::Stylish">Mojolicious::Plugin::Directory::Stylish</a>.
</p>
<p>
  <b>Mojolicious::Plugin::Directory</b>
</p>
<pre>
# Insltall
cpanm Mojolicious::Plugin::Directory

# Serve current directories on your command line
perl -Mojo -E 'a-&gt;plugin("Directory")-&gt;start' daemon
</pre>
<p>
  <b>Mojolicious::Plugin::Directory::Stylish</b>
</p>
<pre>
# Insltall
cpanm Mojolicious::Plugin::Directory::Stylish

# Serve current directories on your command line
perl -Mojo -E 'a-&gt;plugin("Directory::Stylish")-&gt;start' daemon
</pre>
<h3>Install Fonts</h3>
<p>
  If you see character corruption when you get screenshots, the installing of fonts is needed.
</p>
<p>
  I explain the way to install the fonts on some OSs.
</p>
<h4>Ubuntu</h4>
<ul>
  <li><a href="https://en.ubuntu.perlzemi.com/blog/20211124125149.html">Install Fonts on Ubuntu</a></li>
</ul>
<h4>CentOS</h4>
<ul>
  <li><a href="https://en.centos.perlzemi.com/blog/20211124121003.html">Install Fonts on CentOS</a></li>
</ul>
<h3>CSS Selector</h3>
<p>
  If you are familiar with CSS Selector, you can make CSS Selector as the default finder.
</p>
<pre>
# Make CSS Selector as the default finder
$driver-&gt;default_finder('css');
</pre>
<p>
  In this page, I use CSS selector to select elements of HTML.
</p>
<h3>Get An Element</h3>
<p>
  You can get an element using <b>find_element</b> method with CSS selector. The return value is <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>
</p>
<pre>
# Get an element using id CSS selector
my $element = $driver-&gt;find_element("#myid");

# Get an element using class CSS selector
my $element = $driver-&gt;find_element(".myclass");

# Get an element using attirbute CSS selector
my $element = $driver-&gt;find_element("[name=id]");
</pre>
<p>
  Note that <b>find_element</b> method throws exception when the element is not found.
</p>
<p>
  If you want to avoid exceptions, you need to use <a href="/blog/20100312126967.html">eval</a> block.
</p>
<pre>
my $element;
eval {
  $element = $driver-&gt;find_element("#myid");
};
</pre>
<h4>Often Used CSS Selectors</h4>
<p>
  I introduce often used CSS selectors.
</p>
<pre>
# id starts with "myid_"
my $selects_first = $driver-&gt;find_element('[id^=myid_]');
</pre>
<h4>Get a Child Element</h4>
<p>
  If you get a child element of the element, you can use <b>find_child_element</b> method.
</p>
<pre>
# Get a child elemen
my $child_element = $driver-&gt;find_child_element($element, ".myclass");
</pre>
<h3>Get Multiple Elements</h3>
<p>
  You can get multiple elements using <b>find_elements</b> method with CSS selector. The return value is an <a href="https://en.perlzemi.com/blog/20180214151861.html">Array References</a> which contains the list <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<p>
  In this example, I get the button that contains "Signin" using <a href="https://en.perlzemi.com/blog/20161023147731.html">if statement</a> and <a href="https://en.perlzemi.com/blog/20170521149524.html">for statement</a> and <a href="https://en.perlzemi.com/blog/20100827127859.html">Regular Expressions</a>.
</p>
<pre>
# Get Multiple Elements
my $buttons = $driver-&gt;find_elements('button');
for my $button (@$buttons) {
  my $text = $button-&gt;get_text;
  if ($text =~ /Signin/) {
    $button-&gt;click;
  }
}
</pre>
<p>
  Note that <b>find_elements</b> method throws exception when all the elements is not found.
</p>
<p>
  If you want to avoid exceptions, you need to use <a href="/blog/20100312126967.html">eval</a> block.
</p>
<pre>
my $buttons;
eval {
  $buttons = $driver-&gt;find_elements('button');
};
</pre>
<h4>Get Child Elements</h4>
<p>
  If you get child elements of the element, you can use <b>find_child_elements</b> method.
</p>
<pre>
# Get a child elemen
my $child_elements = $driver-&gt;find_child_elements($element, ".myclass");
</pre>
<h3>Text Fields, Password Fields, Text Area</h3>
<p>
  I explain the manipulation of text fields, password fields, text areas.
</p>
<h4>Input Text</h4>
<p>
  You can input text in text fields, password fields, text areas using <b>send_keys</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>. Text are <a href="https://en.perlzemi.com/blog/20161003147558.html">Perl Strings</a>.
</p>
<pre>
# Input text
$input_element-&gt;send_keys("perlclub");
</pre>
<p>
  <b>send_keys</b> method supports Unicode. You need to write "use utf8;" and save the source code as UTF-8.
</p>
<pre>
# Input unicode text
use strict;
use warnings;
use utf8;

# ...

$input_element-&gt;send_keys("あいうえお");
</pre>
<h3>Input Keys from Keybord</h3>
<p>
  I explain the details of input keys from keybord.
</p>
<h4>Input Characters</h4>
<p>
  You can input keys to an element using <b>send_keys</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Input text
$element-&gt;send_keys("perlclub");
</pre>
<h4>Input Unicode Characters</h4>
<p>
  <b>send_keys</b> method supports Unicode. You need to write "use utf8;" and save the source code as UTF-8.
</p>
<pre>
# Input unicode text
use strict;
use warnings;
use utf8;

# ...

$element-&gt;send_keys("あいうえお");
</pre>
<h4>Input Special Keys</h4>
<p>
  You can input special keys such as "space", "enter" using <b>send_keys</b> method with <b>KEYS</b> function <a href="https://metacpan.org/pod/Selenium::Remote::WDKeys">Selenium::Remote::WDKeys</a>.
</p>
<pre>
use Selenium::Remote::WDKeys;

# ...

# Input space
$element-&gt;send_keys(KEYS-&gt;{'space'});

# Input enter
$element-&gt;send_keys(KEYS-&gt;{'enter'});

# Input "up arrow" x 10
$element-&gt;send_keys(KEYS-&gt;{'up_arrow'} x 10);

# Input "down arrow" x 5
$element-&gt;send_keys(KEYS-&gt;{'down_arrow'} x 5);
</pre>
<p>
  The following is the list of constant keys.
</p>
<pre>
null
cancel
help
backspace
tab
clear
return
enter
shift
control
alt
pause
escape
space
page_up
page_down
end
home
left_arrow
up_arrow
right_arrow
down_arrow
insert
delete
semicolon
equals
numpad_0
numpad_1
numpad_2
numpad_3
numpad_4
numpad_5
numpad_6
numpad_7
numpad_8
numpad_9
multiply
add
separator
subtract
decimal
divide
f1
f2
f3
f4
f5
f6
f7
f8
f9
f10
f11
f12
command_meta
ZenkakuHankaku
</pre>
<h3>Checkbox and Radio Button</h3>
<p>
  I explain how to check the chekking of checkboxes and radio buttons and set the chekking of checkboxes and radio buttons.
</p>
<h4>Check the Chekking of Checkboxes and Radio Buttons</h4>
<p>
  You can check the checking of checkboxes or radio buttons using <b>is_selected</b> method of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Check the Chekking of Checkboxes or Radio Buttons
my $is_selected = $element-&gt;is_selected;
</pre>
<h4>Set the Chekking of Checkboxes or Radio Buttons</h4>
<p>
  You can set the chekking of checkboxes or radio buttons <b>set_selected</b> method of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Set the Chekking of Checkboxes or Radio Buttons
$element-&gt;set_selected;
</pre>
<p>
  You maybe see the following error "Other element would receive the click".
</p>
<pre>
Error while executing command: element click intercepted: element click intercepted: Element &lt;input type="checkbox" class="myclass" value="true" id="myid"&gt; is not clickable at point (1009, 210). Other element would receive the click: &lt;label class="mylabel" for="myid"&gt;...&lt;/label&gt;
  (Session info: headless chrome=87.0.4280.88) at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 410.
 at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 361.
</pre>
<p>
  This is because label block receive the click in the logic of <b>set_selected</b> method.
</p>
<p>
  You can write the following codes to click the label. The label block is a sibling of #myid
</p>
<pre>
my $checkbox = $driver-&gt;find_element("#myid");
unless ($checkbox-&gt;is_selected) {
  my $checkbox_label = $driver-&gt;find_element("#myid ~ label");
  $checkbox_label-&gt;set_selected;
}
</pre>
<h3>Click Buttons</h3>
<p>
  You can click buttons using <b>click</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Click Buttons
$button-&gt;click;
</pre>
<p>
  You maybe see the following error "is not clickable".
</p>
<pre>
...&lt;button&gt;...&lt;/button&gt; is not clickable ... at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 410.
 at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 361.
</pre>
<p>
  Note that the clicked button is needed to be displayed.
</p>
<p>
  You can scroll the windows to display the button in the middle of the window using <b>execute_script</b> method and JavaScript's <b>scrollIntoView</b> method.
</p>
<pre>
# Display the button in the middle of the window
$driver-&gt;execute_script('arguments[0].scrollIntoView({block: "center"});', $button);

# Click Buttons
$button-&gt;click;
</pre>
<h4>Examples to click buttons</h4>
<p>
  Click the button that text is "Search".
</p>
<pre>
# Click the button that text is "Search".
my $buttons = $driver-&gt;find_elements('button');
for my $button (@$buttons) {
  my $text = $button-&gt;get_text;
  if ($text =~ /^\s*Search\s*$/) {
    $button-&gt;click;
    last;
  }
}
</pre>
<h3>Get Text</h3>
<p>
  You can get text of an element using <b>get_text</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Get text
my $text = $element-&gt;get_text;
</pre>
<p>
  If you click buttons, you maybe wait a few seconds until the next page is shown using <a href="https://en.perlzemi.com/blog/20170522149546.html">sleep</a> function.
</p>
<pre>
sleep 3;
</pre>
<h3>Execute JavaScript</h3>
<p>
  You can execute JavaScript using <b>execute_script</b> method. The first argument is JavaScript you want to execute. The second argument is an element. This elemenet is passed to the first argument of <b>arguments</b> variable of JavaScript.
</p>
<pre>
$driver-&gt;execute_script('arguments[0].scrollIntoView({block: "center"});', $button);
</pre>
<p>
  If you can't found operations you want to execute in the Selenium::Remote::Driver documents, you can execute any JavaScript using <b>execute_script</b> method.
</p>
<h3>Select Fields</h3>
<p>
  I explain how to select the value of Select Fields. 
</p>
<p>
  1. Display the select field
</p>
<p>
  2. Click the select field.
</p>
<p>
  3. Input down keys
</p>
<p>
  4. Input enter key
</p>
<pre>
# Display the select field
$driver-&gt;execute_script('arguments[0].scrollIntoView({block: "center"});', $select);

# Click the select field
$select-&gt;click;

# Input down keys
$select-&gt;send_keys(KEYS-&gt;{'down_arrow'} x $key_down_count);

# Input enter key
$select-&gt;send_keys(KEYS-&gt;{'enter'});
</pre>
<p>
  "x" is a <a href="https://en.perlzemi.com/blog/20180227151973.html">Perl Repeat Operator</a>.
</p>
<h3>Get Page Source</h3>
<p>
  You can get the page source that is parsed after the web browser using <b>get_page_source</b> method. This is not a pure raw page source.
</p>
<pre>
# Get the page source
my $page_source = $driver-&gt;get_page_source;
</pre>
<h3>Get body Text</h3>
<p>
  You can get the text in the body tag using <b>get_body</b> method. The return value doesn't contain HTML tags, only contains text.
</p>
<pre>
# Get the body text
my $body_text = $driver-&gt;get_body;
</pre>
<h3>Table Manipulation</h3>
<p>
  I introduce examples of table manipulation to iterate each row of the table.
</p>
<pre>
# Table manipulation
my $rows;
eval { $rows = $driver-&gt;find_elements('table.mytable &gt; tr') };
if ($rows) {
  for my $row (@$rows) {
    my $row_text = $row-&gt;get_text;
    if ($row_text =~ /\b(\d{12})\b/a) {
      my $id = $1;
      
      print "$id\n";
    }
  }
}
</pre>
<h3>Donwload Files</h3>
<p>
  I explain how to donwload files using Selenium::Chrome.
</p>
<h4>Set the Download Directory</h4>
<p>
  You can set the download directory using C<prefs> option of <b>new</b> method of Selenium::Chrome.
</p>
<pre>
my $driver = Selenium::Chrome-&gt;new(
  extra_capabilities =&gt; {
    'goog:chromeOptions' =&gt; {
      args =&gt; ['headless', 'disable-gpu', 'window-size=1920,1080', 'no-sandbox' ],
      prefs =&gt; {
          'download.default_directory' =&gt; '/tmp'
      },
    }
  }
);
</pre>
<p>
  Note that you can't specify home direcitories as download directories for security reasones.
</p>
<h4>Download Files</h4>
<p>
  Selenium doesn't have a special features to donload files. Normally, you can download files using <b>click</b> method. You need to wait the finish of the donwloading using <a href="https://en.perlzemi.com/blog/20170522149546.html">sleep</a> method.
</p>
<pre>
# Donwload files
$download_button-&gt;click;
sleep 3;
</pre>
<p>
  <b>Examples:</b>
</p>
<pre>
# Get the download button
my $download_buttons = $driver-&gt;find_elements('button');
my $download_button;
for my $download_button (@$download_buttons) {
  my $download_button_text = $download_button-&gt;get_text;
  
  if ($download_button_text =~ /^\s*Download\s*$/) {
    $download_button = $download_button;
    last;
  }
}

# Donwload the file
if ($download_button) {
  $download_button-&gt;click;
  sleep 3;
}
</pre>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2021/09/21</div>
<h2><a href="/blog/20210921094146.html">Maintainable Perl 7 plan</a></h2>
<p>
  As of 2021, Perl 7 with high maintainability is planned. Perl7 is a new version of Perl that improves the maintainability of Perl, reduces beginner mistakes, and maintains high backward compatibility with the current version of Perl5.
</p>
<p>
  With the following description, it is planned to be able to use the functions of Perl7. The release date is undecided.
</p>
<pre>
use v7;
</pre>
<p>
  In the description of "use v7 ", "use strict;" which makes Perl grammar strict and "use warnings;" which outputs warnings are enabled, and you can write Perl with high maintainability in one line description.
</p>
<p>
  You can use functions that were available as Perl 5 features, such as the say function.
</p>
<pre>
use v7;

say'Hello';
</pre>
<h3>What happened to Perl 7's announcement? </H3>
<p>
  There was <a href="https://www.perl.com/article/announcing-perl-7/">Perl 7 announcement</a> on Perl.com in June 2020, but it was announced. The content is now updated.
</p>
<h3>What happened to Perl6? </H3>
<p>
  <a href="/blog/20210605102758.html">Perl6</a>, which was once developed as a successor to Perl5, has been renamed to Raku. As of 2021, some sites mention Perl 6 as it is without updating the information, but the correct information is that Perl 6 has been renamed to Raku.
</p>
<h3>Relationship between Perl 7, Perl 6, and Perl 5</h3>
<p>
  There is so much misunderstanding and confusion about Perl 7, Perl 6, and Perl 5. I feel this is the responsibility of Perl, and I feel that things will get better a few years after Perl 7 is officially released.
</p>
<p>
  To reduce misunderstandings and confusion, I'll write about the 2021 versions of Perl 7, Perl 6, and Perl 5.
</p>
<h4>The latest version of Perl is Perl 5.34</h4>
<p>
  The latest version of Perl in 2021 is Perl 5.34. The latest version of Perl 5 is the latest version of Perl.
</p>
<h4>Perl 6 renamed to Raku</h4>
<p>
  Perl 6, which was supposed to be the next version of Perl, is now defined as a different programming language and has been renamed to Raku.
</p>
<h4>The next Perl will be Perl 7, the release date of Perl 7 is undecided</h4>
<p>
  It has been decided that the next Perl will be released as Perl 7 with very high compatibility with the current Perl 5.
</p>
<pre>
use v7;
</pre>
<p>
  With the description, you can use the functions of Perl 7.
</p>
<p>
  The release date for Perl 7 is undecided as of September 2021.
</p>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2021/09/03</div>
<h2><a href="/blog/20210903122616.html">How to display UTF - 8 at the Windows command prompt</a></h2>
<p>
  I will show you how to display UTF-8 at the Windows command prompt. It was confirmed on Windows 10 on September 3, 2021.
</p>
<p>
  Create a command prompt shortcut. Right-click to display properties. The link destination is as follows. The code 65001 is the UTF-8 code.
</p>
<pre>
%windir%\system32\cmd.exe/k "chcp 65001"
</pre>
<p>
  <img src="/images/command prompt/win_command_utf8.png">
</p>
<p>
  For Perl programs, writing the source code in UTF-8 is currently the recommended method, so it's nice to be able to view UTF-8 at the command prompt.
</p>
<p>
  I referred to the following information.
</p>
<p>
  <a href="https://qiita.com/s4i/items/75c19c9feb10b54c1ce9">How to change the character code to UTF-8 when PowerShell starts - Qiita</a>
</p>


  </div>
  <div class="bottom">
    <h3>Related Informatrion</h3>

<div style="margin:10px 10px;"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4525414114581084"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-4525414114581084"
     data-ad-slot="9163995495"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>

  </div>
</div>

        </div>
        <div class="side">
          <div style="margin-bottom:30px">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4525414114581084"
     crossorigin="anonymous"></script>
<!-- ディスプレイ縦長 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4525414114581084"
     data-ad-slot="4544919209"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>

<div class="side_list">
  <div class="side_list_body">
    <ul>
      <li>
        <div class="side_list_image">
          <a rel="nofollow" href="/list.html">New Articles</a><br>
          <a rel="nofollow" href="https://twitter.com/perlzemien">Updated Articles</a>
        </div>
      </li>
    </ul>
  </div>
</div>

        </div>
      </div>
      <div class="footer">
        <div class="perlri_link">
  <a rel="nofollow" href="https://perlclub.net/en">Perl Club</a>
</div>

      </div>
    </div>
  </body>
</html>
