<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">

<meta name="google-site-verification" content="4cR7WuQWEtkbu8ThfxGkT1vACiVi5Q_8ykfkRudOnTU" />

<link rel="shortcut icon" href="/images/logo.png">
<link rel="stylesheet" type="text/css" href="/css/common.css"><script type="text/javascript" src="/js/jquery-1.9.0.min.js"></script>
<script type="text/javascript" src="/js/google-code-prettify/prettify.js"></script>
<link  type="text/css" rel="stylesheet" href="/js/google-code-prettify/prettify.css"/>
<script>
  $(function(){
    // google code prettifyの有効化
    $("pre").addClass("prettyprint");
    function init(event){
      prettyPrint();
    }
    if(window.addEventListener)window.addEventListener("load",init,false);
    else if(window.attachEvent)window.attachEvent("onload",init);
    
    $(".to-top").click(function() {
      // ページの一番上までスクロールさせます。
      $('body, html').animate({scrollTop: 0}, 300, 'linear');;
    });
  });
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JDYCKHXVT5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JDYCKHXVT5');
</script>

  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="header_main">  <h1>    <a href="/"><img src="/images/logo.png">Perl Zemi</a>
</h1>
</div>

      </div>
      <div class="main">
        <div class="content">
          <div class="entry">
  <div class="top">
    
  </div>
  <div class="middle">
    <div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2021/11/19</div>
<h2><a href="/blog/20211119124656.html">JavaScript Supported Web Scraping using Perl and Selenium</a></h2>
<p>
  I explain JavaScript supported web scraping using Perl and <a href="https://metacpan.org/pod/Selenium::Remote::Driver">Selenium::Remote::Driver</a>. Selenium::Remote::Driver is a Perl module for Selenium. Selenium provides the APIs for JavaScript supported web scraping. 
</p>
<h3>Download and Install Perl</h3>
<p>
  See the following articles about how to donwload and install Perl. Windows, Max, Linux/UNIX are supported.
</p>
<ul>
  <li><a href="/blog/20180820153471.html">Download and Install Perl</a></li>
</ul>
<h3>Download and Install Google Chrome</h3>
<p>
  I explain the way to install web browsers.
</p>
<h4>Windows and Mac</h4>
<p>
  You can download and install Google Chrome in the following page.
</p>
<ul>
 <li><a href="https://www.google.com/chrome/">Google Chrome - Download</a></li>
</ul>
<h4>Linux</h4>
<p>
  In Linux you maybe install Google Chrome using package managers. I try the installing Google Chrome on the some Linux distributions.
</p>
<h5>Ubuntu</h5>
<ul>
 <li><a href="https://en.ubuntu.perlzemi.com/blog/20211117083934.html">Install Google Chrome on Ubuntu</a></li>
</ul>
<h5>CentOS</h5>
<ul>
 <li><a href="https://en.centos.perlzemi.com/blog/20210104090837.html">Install Google Chrome on CentOS</a></li>
</ul>
<h4>Check the version of Google Chrome</h4>
<p>
  Check the version of Google Chrome.
</p>
<pre>
google-chrome --version
</pre>
<p>
  An example of the output:
</p>
<pre>
Google Chrome 87.0.4280.88
</pre>
<h3>Download and Install ChromeDriver</h3>
<p>
  ChromeDriver is a web driver. Web drivers is tools to control Web browsers by using programs.
</p>
<h5>Ubuntu</h5>
<ul>
 <li><a href="https://en.ubuntu.perlzemi.com/blog/20211116083934.html">Install ChromeDriver on Ubuntu</a></li>
</ul>
<h5>CentOS</h5>
<ul>
 <li><a href="https://en.centos.perlzemi.com/blog/20210103090837.html">Install ChromeDriver on CentOS</a></li>
</ul>
<h4>Check the version of ChromeDriver</h4>
<p>
  Check the version of ChromeDriver.
</p>
<pre>
chromedriver --version
</pre>
<p>
  An example of the output:
</p>
<pre>
ChromeDriver 87.0.4280.88 (89e2380a3e36c3464b5dd1302349b1382549290d-refs/branch-heads/4280@{#1761})
</pre>
<p>
  It is good that the version of ChromeDriver is the same as Google Chrome to prevent problems.
</p>
<h3>Install Selenium::Remote::Driver</h3>
<p>
  Let's install <a href="https://metacpan.org/pod/Selenium::Remote::Driver">Selenium::Remote::Driver</a> using <a href="/blog/20101027127859.html">cpanm</a> or <a href="/blog/20100504127089.html">cpan</a>. Selenium::Remote::Driver is a Perl module for Selenium.
</p>
<pre>
# cpanm
cpanm Selenium::Remote::Driver

# cpan
cpan Selenium::Remote::Driver
</pre>
<h3>Get a Web Page using Selenium</h3>
<p>
  Get a Web Page using Selenium.
</p>
<h4>Load Selenium::Chrome</h4>
<p>
  Let's load <b>Selenium::Chrome</b>. Selenium::Chrome is a sub class of Selenium::Remote::Driver for Google Chrome.
</p>
<pre>
use Selenium::Chrome;
</pre>
<h4>Create a Selenium::Chrome Object</h4>
<p>
  Create a Selenium::Chrome object with headless options.
</p>
<pre>
my $driver = Selenium::Chrome-&gt;new(
  extra_capabilities =&gt; {
    'goog:chromeOptions' =&gt; {
      args =&gt; ['headless', 'disable-gpu', 'window-size=1920,1080', 'no-sandbox' ]
    }
  }
);
</pre>
<p>
  These options is needed for headless execution. Headless execution means you get a page without the GUI of Google Chrome.
</p>
<p>
  If there are no these options and you don't have GUI display, you will see the following error message.
</p>
<pre>
Could not create new session: unknown error: Chrome failed to start: exited abnormally.

(unknown error: DevToolsActivePort file doesn't exist) (The process started from chrome location /usr/bin/google-chrome is no longer running, so ChromeDriver is assuming that Chrome has crashed.) at access.pl line 79.
</pre>
<h4>Shutdown a Selenium::Chrome Object</h4>
<p>
  If you finish the use of Selenium::Chrome, you need to shutdown it.
</p>
<pre>
$driver-&gt;shutdown_binary;
</pre>
<h4>Get a Web Page and the Title</h4>
<p>
  You can get a web page using a <b>get</b> method.
</p>
<pre>
$driver-&gt;get('http://www.google.com');
</pre>
<p>
  You can get the title using a <b>get_title</b> method.
</p>
<pre>
my $title = $driver-&gt;get_title;
</pre>
<p>
  <b>Examples:</b>
</p>
<p>
  This is an example to get a page and the title.
</p>
<pre>
use Selenium::Chrome;

# Create a Selenium::Chrome object
my $driver = Selenium::Chrome-&gt;new(
  extra_capabilities =&gt; {
    'goog:chromeOptions' =&gt; {
      args =&gt; ['headless', 'disable-gpu', 'window-size=1920,1080', 'no-sandbox' ]
    }
  }
);

# Get a page
$driver-&gt;get('http://www.google.com');

# Get the title
my $title = $driver-&gt;get_title;

print "$title\n";

# Shutdown
$driver-&gt;shutdown_binary;
</pre>
<p>
  The output:
</p>
<pre>
Google
</pre>
<h4>Get the Screenshot</h4>
<p>
  You can get the screenshot using <b>capture_screenshot</b> method.
</p>
<pre>
$driver-&gt;capture_screenshot("screenshot.png");
</pre>
<p>
  If you want to save the screenshot to the program directory, you can use <a href="/blog/20100524127696.html">FindBin</a> module.
</p>
<pre>
use FindBin;

$driver-&gt;capture_screenshot("$FindBin::Bin/screenshot.png");
</pre>
<p>
  If you want to serve the screenshot file and see it on your web browser, you can use <a href="https://metacpan.org/pod/Mojolicious::Plugin::Directory::Stylish">Mojolicious::Plugin::Directory::Stylish</a>.
</p>
<pre>
# Insltall
cpanm Mojolicious::Plugin::Directory::Stylish

# Serve current directories on your command line
perl -Mojo -E 'a-&gt;plugin("Directory::Stylish")-&gt;start' daemon
</pre>
<h3>Install Fonts</h3>
<p>
  If you see character corruption when you get screenshots, the installing of fonts is needed.
</p>
<p>
  I explain the way to install the fonts on some OSs.
</p>
<h4>Ubuntu</h4>
<ul>
  <li><a href="https://en.ubuntu.perlzemi.com/blog/20211124125149.html">Install Fonts on Ubuntu</a></li>
</ul>
<h4>CentOS</h4>
<ul>
  <li><a href="https://en.centos.perlzemi.com/blog/20211124121003.html">Install Fonts on CentOS</a></li>
</ul>
<h3>CSS Selector</h3>
<p>
  If you are familiar with CSS Selector, you can make CSS Selector as the default finder.
</p>
<pre>
# Make CSS Selector as the default finder
$driver-&gt;default_finder('css');
</pre>
<p>
  In this page, I use CSS selector to select elements of HTML.
</p>
<h3>Get An Element</h3>
<p>
  You can get an element using <b>find_element</b> method with CSS selector. The return value is <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>
</p>
<pre>
# Get an element using id CSS selector
my $element = $driver-&gt;find_element("#myid");

# Get an element using class CSS selector
my $element = $driver-&gt;find_element(".myclass");

# Get an element using attirbute CSS selector
my $element = $driver-&gt;find_element("[name=id]");
</pre>
<p>
  Note that <b>find_element</b> method throws exception when the element is not found.
</p>
<p>
  If you want to avoid exceptions, you need to use <a href="/blog/20100312126967.html">eval</a> block.
</p>
<pre>
my $element;
eval {
  $element = $driver-&gt;find_element("#myid");
};
</pre>
<h4>Often Used CSS Selectors</h4>
<p>
  I introduce often used CSS selectors.
</p>
<pre>
# id starts with "myid_"
my $selects_first = $driver-&gt;find_element('[id^=myid_]');
</pre>
<h3>Get Multiple Elements</h3>
<p>
  You can get multiple elements using <b>find_elements</b> method with CSS selector. The return value is an <a href="https://en.perlzemi.com/blog/20180214151861.html">array reference</a> which contains the list <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>
</p>
<pre>
# Get Multiple Elements
my $buttons = $driver-&gt;find_elements('button');
for my $button (@$buttons) {
  my $text = $button-&gt;get_text;
  if ($text =~ /Signin/) {
    $button-&gt;click;
  }
}
</pre>
<p>
  Note that <b>find_elements</b> method throws exception when all the elements is not found.
</p>
<p>
  If you want to avoid exceptions, you need to use <a href="/blog/20100312126967.html">eval</a> block.
</p>
<pre>
my $buttons;
eval {
  $buttons = $driver-&gt;find_elements('button');
};
</pre>
<h3>Text Fields, Password Fields, Text Area</h3>
<p>
  I explain the manipulation of text fields, password fields, text areas.
</p>
<h4>Input Text</h4>
<p>
  You can input text in text fields, password fields, text areas using <b>send_keys</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Input text
$input_element-&gt;send_keys("perlclub");
</pre>
<p>
  <b>send_keys</b> method supports Unicode. You need to write "use utf8;" and save the source code as UTF-8.
</p>
<pre>
# Input unicode text
use strict;
use warnings;
use utf8;

# ...

$input_element-&gt;send_keys("あいうえお");
</pre>
<h3>Input Keys from Keybord</h3>
<p>
  I explain the details of input keys from keybord.
</p>
<h4>Input Characters</h4>
<p>
  You can input keys to an element using <b>send_keys</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Input text
$element-&gt;send_keys("perlclub");
</pre>
<h4>Input Unicode Characters</h4>
<p>
  <b>send_keys</b> method supports Unicode. You need to write "use utf8;" and save the source code as UTF-8.
</p>
<pre>
# Input unicode text
use strict;
use warnings;
use utf8;

# ...

$element-&gt;send_keys("あいうえお");
</pre>
<h4>Input Special Keys</h4>
<p>
  You can input special keys such as "space", "enter" using <b>send_keys</b> method with <b>KEYS</b> function <a href="https://metacpan.org/pod/Selenium::Remote::WDKeys">Selenium::Remote::WDKeys</a>.
</p>
<pre>
use Selenium::Remote::WDKeys;

# ...

# Input space
$element-&gt;send_keys(KEYS-&gt;{'space'});

# Input enter
$element-&gt;send_keys(KEYS-&gt;{'enter'});

# Input "up arrow" x 10
$element-&gt;send_keys(KEYS-&gt;{'up_arrow'} x 10);

# Input "down arrow" x 5
$element-&gt;send_keys(KEYS-&gt;{'down_arrow'} x 5);
</pre>
<p>
  The following is the list of constant keys.
</p>
<pre>
null
cancel
help
backspace
tab
clear
return
enter
shift
control
alt
pause
escape
space
page_up
page_down
end
home
left_arrow
up_arrow
right_arrow
down_arrow
insert
delete
semicolon
equals
numpad_0
numpad_1
numpad_2
numpad_3
numpad_4
numpad_5
numpad_6
numpad_7
numpad_8
numpad_9
multiply
add
separator
subtract
decimal
divide
f1
f2
f3
f4
f5
f6
f7
f8
f9
f10
f11
f12
command_meta
ZenkakuHankaku
</pre>
<h3>Checkbox and Radio Button</h3>
<p>
  I explain how to check the chekking of checkboxes and radio buttons and set the chekking of checkboxes and radio buttons.
</p>
<h4>Check the Chekking of Checkboxes and Radio Buttons</h4>
<p>
  You can check the checking of checkboxes or radio buttons using <b>is_selected</b> method of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Check the Chekking of Checkboxes or Radio Buttons
my $is_selected = $element-&gt;is_selected;
</pre>
<h4>Set the Chekking of Checkboxes or Radio Buttons</h4>
<p>
  You can set the chekking of checkboxes or radio buttons <b>set_selected</b> method of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Set the Chekking of Checkboxes or Radio Buttons
$element-&gt;set_selected;
</pre>
<p>
  You maybe see the following error "Other element would receive the click".
</p>
<pre>
Error while executing command: element click intercepted: element click intercepted: Element &lt;input type="checkbox" class="myclass" value="true" id="myid"&gt; is not clickable at point (1009, 210). Other element would receive the click: &lt;label class="mylabel" for="myid"&gt;...&lt;/label&gt;
  (Session info: headless chrome=87.0.4280.88) at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 410.
 at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 361.
</pre>
<p>
  This is because label block receive the click in the logic of <b>set_selected</b> method.
</p>
<p>
  You can write the following codes to click the label. The label block is a sibling of #myid
</p>
<pre>
my $checkbox = $driver-&gt;find_element("#myid");
unless ($checkbox-&gt;is_selected) {
  my $checkbox_label = $driver-&gt;find_element("#myid ~ label");
  $checkbox_label-&gt;set_selected;
}
</pre>
<h3>Click Buttons</h3>
<p>
  You can click buttons using <b>click</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Click Buttons
$button-&gt;click;
</pre>
<p>
  You maybe see the following error "is not clickable".
</p>
<pre>
...&lt;button&gt;...&lt;/button&gt; is not clickable ... at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 410.
 at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 361.
</pre>
<p>
  Note that the clicked button is needed to be displayed.
</p>
<p>
  You can scroll the windows to display the button in the middle of the window using <b>execute_script</b> method and JavaScript's <b>scrollIntoView</b> method.
</p>
<pre>
# Display the button in the middle of the window
$driver-&gt;execute_script('arguments[0].scrollIntoView({block: "center"});', $button);

# Click Buttons
$button-&gt;click;
</pre>
<h4>Examples to click buttons</h4>
<p>
  Click the button that text is "Search".
</p>
<pre>
# Click the button that text is "Search".
my $buttons = $driver-&gt;find_elements('button');
for my $button (@$buttons) {
  my $text = $button-&gt;get_text;
  if ($text =~ /^\s*Search\s*$/) {
    $button-&gt;click;
    last;
  }
}
</pre>
<h3>Get Text</h3>
<p>
  You can get text of an element using <b>get_text</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Get text
my $text = $element-&gt;get_text;
</pre>
<p>
  If you click buttons, you maybe wait a few seconds until the next page is shown using <a href="https://en.perlzemi.com/blog/20170522149546.html">sleep</a> function.
</p>
<pre>
sleep 3;
</pre>
<h3>Execute JavaScript</h3>
<p>
  You can execute JavaScript using <b>execute_script</b> method. The first argument is JavaScript you want to execute. The second argument is an element. This elemenet is passed to the first argument of <b>arguments</b> variable of JavaScript.
</p>
<pre>
$driver-&gt;execute_script('arguments[0].scrollIntoView({block: "center"});', $button);
</pre>
<p>
  If you can't found operations you want to execute in the Selenium::Remote::Driver documents, you can execute any JavaScript using <b>execute_script</b> method.
</p>
<h3>Select Fields</h3>
<p>
  I explain how to select the value of Select Fields. 
</p>
<p>
  1. Display the select field
</p>
<p>
  2. Click the select field.
</p>
<p>
  3. Input down keys
</p>
<p>
  4. Input enter key
</p>
<pre>
# Display the select field
$driver-&gt;execute_script('arguments[0].scrollIntoView({block: "center"});', $select);

# Click the select field
$select-&gt;click;

# Input down keys
$select-&gt;send_keys(KEYS-&gt;{'down_arrow'} x $key_down_count);

# Input enter key
$select-&gt;send_keys(KEYS-&gt;{'enter'});
</pre>
<h3>Get Page Source</h3>
<p>
  You can get the page source that is parsed after the web browser using <b>get_page_source</b> method. This is not a pure raw page source.
</p>
<pre>
# Get the page source
my $page_source = $driver-&gt;get_page_source;
</pre>
<h3>Get body Text</h3>
<p>
  You can get the text in the body tag using <b>get_body</b> method. The return value doesn't contain HTML tags, only contains text.
</p>
<pre>
# Get the body text
my $body_text = $driver-&gt;get_body;
</pre>
<p>
  (Uncompleted)
</p>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2021/09/21</div>
<h2><a href="/blog/20210921094146.html">Maintainable Perl 7 plan</a></h2>
<p>
  As of 2021, Perl 7 with high maintainability is planned. Perl7 is a new version of Perl that improves the maintainability of Perl, reduces beginner mistakes, and maintains high backward compatibility with the current version of Perl5.
</p>
<p>
  With the following description, it is planned to be able to use the functions of Perl7. The release date is undecided.
</p>
<pre>
use v7;
</pre>
<p>
  In the description of "use v7 ", "use strict;" which makes Perl grammar strict and "use warnings;" which outputs warnings are enabled, and you can write Perl with high maintainability in one line description.
</p>
<p>
  You can use functions that were available as Perl 5 features, such as the say function.
</p>
<pre>
use v7;

say'Hello';
</pre>
<h3>What happened to Perl 7's announcement? </H3>
<p>
  There was <a href="https://www.perl.com/article/announcing-perl-7/">Perl 7 announcement</a> on Perl.com in June 2020, but it was announced. The content is now updated.
</p>
<h3>What happened to Perl6? </H3>
<p>
  <a href="/blog/20210605102758.html">Perl6</a>, which was once developed as a successor to Perl5, has been renamed to Raku. As of 2021, some sites mention Perl 6 as it is without updating the information, but the correct information is that Perl 6 has been renamed to Raku.
</p>
<h3>Relationship between Perl 7, Perl 6, and Perl 5</h3>
<p>
  There is so much misunderstanding and confusion about Perl 7, Perl 6, and Perl 5. I feel this is the responsibility of Perl, and I feel that things will get better a few years after Perl 7 is officially released.
</p>
<p>
  To reduce misunderstandings and confusion, I'll write about the 2021 versions of Perl 7, Perl 6, and Perl 5.
</p>
<h4>The latest version of Perl is Perl 5.34</h4>
<p>
  The latest version of Perl in 2021 is Perl 5.34. The latest version of Perl 5 is the latest version of Perl.
</p>
<h4>Perl 6 renamed to Raku</h4>
<p>
  Perl 6, which was supposed to be the next version of Perl, is now defined as a different programming language and has been renamed to Raku.
</p>
<h4>The next Perl will be Perl 7, the release date of Perl 7 is undecided</h4>
<p>
  It has been decided that the next Perl will be released as Perl 7 with very high compatibility with the current Perl 5.
</p>
<pre>
use v7;
</pre>
<p>
  With the description, you can use the functions of Perl 7.
</p>
<p>
  The release date for Perl 7 is undecided as of September 2021.
</p>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2021/09/03</div>
<h2><a href="/blog/20210903122616.html">How to display UTF - 8 at the Windows command prompt</a></h2>
<p>
  I will show you how to display UTF-8 at the Windows command prompt. It was confirmed on Windows 10 on September 3, 2021.
</p>
<p>
  Create a command prompt shortcut. Right-click to display properties. The link destination is as follows. The code 65001 is the UTF-8 code.
</p>
<pre>
%windir%\system32\cmd.exe/k "chcp 65001"
</pre>
<p>
  <img src="/images/command prompt/win_command_utf8.png">
</p>
<p>
  For Perl programs, writing the source code in UTF-8 is currently the recommended method, so it's nice to be able to view UTF-8 at the command prompt.
</p>
<p>
  I referred to the following information.
</p>
<p>
  <a href="https://qiita.com/s4i/items/75c19c9feb10b54c1ce9">How to change the character code to UTF-8 when PowerShell starts - Qiita</a>
</p>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2021/07/26</div>
<h2><a href="/blog/20210726104613.html">Summary of how to create a web browser automatic operation robot with Perl - Let's make a practical RPA with Perl (start writing)</a></h2>
<p>
  Here is a summary of how to create a web browser automatic operation robot in Perl. For Windows users.
</p>
<h3>Install Strawberry Perl on Windows</h3>
<p>
  To create a web browser auto-operation robot, you need Perl set up for Windows.
</p>
<p>
  There is a choice between Active Perl and Strawberry Perl, but here we will use Strawberry Perl.
</p>
<p>
  Strawberry Perl has a GUI operation module installed to create a web browser automatic operation robot. Mouse position specification, click, keyboard operation, clipboard operation, etc.
</p>
<p>
  <a href="https://perlzemi.com/blog/20180808153368.html">Installing Strawberry Perl</a>
</p>
<h3>Perl module used to create a web browser automatic operation robot</h3>
<p>
  Web browser automatic operation Perl modules used to create robots are mainly as follows.
</p>
<ul>
  <li> Win32::GuiTest - Mouse position specification, keyboard operation </li>
  <li> Win32::Clipboard - Clipboard operation </li>
</ul>
<h3>Window operation</h3>
<p>
  On Windows, use Win32::GuiTest to get windows, position the mouse, click, and operate the keyboard. Loading the required function.
</p>
<pre>
use Win32::GuiTest (
  'Unicode Semantics',
  'GetDesktopWindow',
  'GetParent',
  'GetWindowText',
  'GetClassName',
  'GetChildWindows',
  'GetChildDepth',
  'MouseMoveAbsPix',
  'SendLButtonUp',
  'SendLButtonDown',
  'Send Keys',
);
</pre>
<h4>Enable Unicode semantics</h4>
<p>
  First of all, Perl is Unicode-enabled since Perl 5.8, so Win32::GuiTest will also be able to use Unicode-enabled semantics. It is assumed that the Perl source code is written in UTF-8 and "use utf8;" is written.
</p>
<pre>
# Enable unicode semantics
Unicode Semantics (1);
</pre>
<h4>Get desktop window</h4>
<p>
  To get the desktop window, use the GetDesktopWindow function. A desktop window is a window that shows the entire desktop.
</p>
<pre>
# Get desktop window
my $desktop_win = GetDesktopWindow ();
</pre>
<h4>Get a list of child windows</h4>
<p>
  In order to perform automatic operation of the web browser, it is necessary to get the window of the browser, but in order to do so, it is necessary to first get the list of child windows managed under the desktop window. Use GetChildWindows to get a list of child windows.
</p>
<pre>
# Get a list of child windows
my @windows = GetChildWindows ($desktop_win);

# Loop child window
for my $window (@windows) {
  
}
</pre>
<h4>Get the text of the window</h4>
<p>
  Use the GetWindowText function to get the text of the window.
</p>
<pre>
# Get the text of the window
my $win_text = GetWindowText ($win);
</pre>
<p>
  The text in the window can vary depending on the browser type. In what I checked with Google Chrome, it was "Window title-Application name" as shown below.
</p>
<pre>
Perl Club-Google Chrome
</pre>
<h4>Get the target window</h4>
<p>
  If you want to create a web browser automatic operation robot, you need to get the target window from the list of child windows. Write an example to get the target window. Make sure that the target page of the target web browser is launched.
</p>
<pre>
# Get the target window (Perl Club-Google Chrome)
my $win;
{
  my $desktop_win = GetDesktopWindow ();
  die "Oops!" if GetParent ($desktop_win) != 0;

  my @browser_wins;
  my $browser_name = 'Chrome';
  for my $win (GetChildWindows ($desktop_win)) {

    # Window name
    my $win_text = GetWindowText ($win);

    # Browser name
    if ($win_text =~ /\b $browser_name\b/) {
      if ($win_text =~ /Perl Club/) {
        push @browser_wins, $win;
      }
    }
  }

  my $browser_wins_count = @browser_wins;
  unless ($browser_wins_count == 1) {
    die "Must be open one window");
  }
  $win = $browser_wins[0];
}
</pre>
<!-
<h4>Keyboard input</h4>
    # Go to Console tab
    SendKeys ('^]');
    # Go to Elements tab
    SendKeys ('^[');
    
    # Move to the tag below
    SendKeys ('{DOWN}');
    # Move to the tag above (body can be selected
    SendKeys ('{UP}');
<p>
  SendKeys ('^c');
</p>
  SendKeys ('^l');
  SendKeys ('^v');
  SendKeys ('{ENTER}');
  SendKeys ('{TAB}' x $baibai_bukken_search_button_tab_press_count);
  SendKeys ('^v');
    SendKeys ('{LEFT}');
  SendKeys ('{RIGHT}' x $bukken_search_results_pagenation_forword_right_count_max);
  SendKeys ('{F12}');
    SendKeys ('^]');
    SendKeys ('^[');
    SendKeys ('{DOWN}');
    SendKeys ('{UP}');
  SendKeys ('^c');
  SendKeys ('{F12}');
<p>
  ->
</p>
<h3>Clipboard</h3>
<p>
  Use the Win32::Clipboard module to work with the Windows clipboard.
</p>
<pre>
use Win32::Clipboard;
</pre>
<h4>Clipboard object generation</h4>
<p>
  First create a clipboard object.
</p>
<pre>
# Clipboard object creation
my $clip = Win32::Clipboard-&gt;new;
</pre>
<h4>Save Perl string to clipboard</h4>
<p>
  Save the Perl string with the Set method. It is assumed that the Perl source code is written in UTF-8 and "use utf8;" is written. When saving a string from the Perl side to the Windows clipboard, encode it in cp932 and pass it. This is because the character code of the text on the Windows clipboard is cp932.
</p>
<pre>
# Save string to clipboard
$clip-&gt;Set(encode('cp932', $string));
</pre>
<h4>Extract Perl string from clipboard</h4>
<p>
  By specifying "CF_UNICODETEXT" in the argument of the GetAs method, it can be obtained in one Unicode encoding format called "UTF16-LE". Convert this to a Perl string using the Perl Encode function decode function. You can get the contents of the Windows clipboard as a Perl string. Please note that you cannot get it correctly with just the GetText function.
</p>
<pre>
# Fetch a Perl string from the clipboard
my $string = $CLIP-&gt;GetAs(CF_UNICODETEXT);
$text = Encode::decode("UTF16-LE", $string);
</pre>
<h4>Paste the contents of the clipboard to the form part</h4>
<p>
  Send "Ctrl + c" to paste the contents of the clipboard into a text field or form part such as a text area. "^" Means "Ctrl".
</p>
<pre>
# Paste the contents of the clipboard into a form part
SendKeys ('^c');
</pre>
<h3>Points for creating RPA robots</h3>
<h4>Wait for browser response</h4>
<p>
  If you want to wait for the browser response, use the sleep function. Set the seconds as safe as possible when the browser response is returned. However, it depends on the network conditions, so it may happen that the next operation starts and the operation changes without returning.
</p>
<pre>
# Wait 3 seconds
sleep 3;
</pre>
<h3>Notes on RPA robots</h3>
<p>
  RPA is a method with many problems in processing automation and operational efficiency. RPA robots are impressed with their movement the moment they see them, but keep in mind that processing speed, program maintainability, and automation are unreliable.
</p>
<p>
  "What if the GUI screen changes due to a Windows upgrade?" "What if the button position or text display changes due to an update of the Web service?" "What if the Web response does not come back for 5 seconds?" " Who starts the program every day? What if I forget it? "" How do you work with other programs running on Linux? "
</p>
<p>
  The first basic and effective methods that can be taken to automate processing and improve work efficiency are text conversion, command conversion, Web conversion, batching, and RDBMS conversion.
</p>
<p>
  Why not consider these five basic measures first? RPA will be effective for a limited area.
</p>
<p>
  (Still continuing)
</p>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2021/06/05</div>
<h2><a href="/blog/20210605102758.html">Perl 6 has been renamed to Raku, and Perl 7 is planned to succeed Perl 5</a></h2>
<p>
  Perl 6, which was once developed as the successor to Perl 5, has been renamed to Raku.
</p>
<h4>What happens to Perl? </H4>
<p>
  Perl is currently planning a new version of Perl, <b> Perl 7 </b>, for future releases. In Perl 6, "6" is included in the language name, but in Perl 7, "7" is not part of the language name, but a major version number.
</p>
<ul>
   <li> <a href="/blog/20210921094146.html">Maintainable Perl 7 plan</a> </li>
</ul>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2021/01/07</div>
<ol class = "bread" itemscope itemtype = "http://schema.org/BreadcrumbList">  <li itemprop = "itemListElement" itemscope itemtype = "http://schema.org/ListItem">    <a itemprop="item" href="/">        <span itemprop = "name">Perl </span></a>
    <meta itemprop = "position" content = "1" />
  </li>
  &#8250;
  <li itemprop = "itemListElement" itemscope itemtype = "http://schema.org/ListItem">    <a itemprop="item" href="/blog/20091116124667.html">      <span itemprop = "name">Module </span></a>
    <meta itemprop = "position" content = "2" />
  </li>
  &#8250;
  <li>
    here
  </li>
</ol>
<h2><a href="/blog/20210107090920.html">Selenium::Chrome - JavaScript - enabled web scraping using Chrome</a></h2>
<p>
  Selenium::Chrome allows you to use Chrome for JavaScript-enabled web scraping. Selenium::Chrome is an extension of <a href="/blog/20210105145700.html">Selenium::Remote::Driver</a> for Chrome. You can use it by installing Selenium::Remote::Driver.
</p>
<h4>When running on Windows, Mac</h4>
<pre>
# When running on Windows, Mac
use Selenium::Chrome;
my $driver = Selenium::Chrome-&gt;new;
$driver-&gt;get('http://www.google.com');
print $driver-&gt;get_title();
$driver-&gt;shutdown_binary();
</pre>
<h4>When executing headless when there is no GUI screen such as Unix/Linux</h4>
<p>
  If you want to execute on the CUI screen when there is no GUI environment, execute headless as follows.
</p>
<pre>
# When executing headless when there is no GUI screen such as Unix/Linux
use Selenium::Chrome;
my $driver = Selenium::Chrome-&gt;new(
  extra_capabilities =&gt; {
    'goog: chromeOptions' =&gt; {
      args =&gt; ['headless', 'disable-gpu', 'window-size = 1920,1080', 'no-sandbox']
    }
  }
);
$driver-&gt;get('http://www.google.com');
print $driver-&gt;get_title();
$driver-&gt;shutdown_binary();
</pre>
<p>
  If the following error occurs, please execute headless with the above option.
</p>
<blockquote>
<p>
  Could not create new session: unknown error: Chrome failed to start: exited abnormally.
</p>
  (unknown error: DevToolsActivePort file doesn't exist)
  (The process started from chrome location/usr/bin/google-chrome is no longer running, so ChromeDriver is assuming that Chrome has crashed.) At access.pl line 79.
</blockquote>
<h3>Preparation of execution environment</h3>
<p>
  Chrome browser and Chrome Driver are required as an execution environment for JavaScript-compatible web scraping using Selenium::Chrome. Chrome Driver is software for operating Chrome itself. The environment construction procedure differs depending on the OS, refer to the following.
</p>
<p>
  It's a good idea to match Chrome browser and Chrome Driver versions as much as possible to avoid binary compatibility issues.
</p>
<h4>For Unix/Linux</h4>
<p>
  <a href="https://en.centos.perlzemi.com/blog/20210103090837.html">Install Chrome Driver - Cent OS 7</a>
</p>
<p>
  <a href="https://en.centos.perlzemi.com/blog/20210104090837.html">Install Google Chrome - CentOS 7</a>
</p>
<p>
  For other <a href="https://linux.perlclub.net/">UNIX/Linux</a> such as Ubuntu, Debian, FreeBSD, try searching for the Chrome browser itself and how to install the Chrome Driver. Let's do it.
</p>
<h4>Windows</h4>
<p>
  <a href="https://qiita.com/omokawa_yasu/items/2d985efb346dd889fe27">On the SPA site, the environment construction procedure of performing GUI test with Selenium::Remote::Driver</a> will be helpful.
</p>
<p>
  <a href="https://perlzemi.com/blog/20080602121231.html">Active Perl</a> but <a href="https://perlzemi.com/blog/20180808153368.html">Strawberry Perl </a> I think it's okay.
</p>
<h4>For Mac</h4>
<p>
  <a href="https://sironekotoro.hateblo.jp/entry/2020/06/06/185455">Using Selenium from Perl</a> The environment construction procedure will be helpful.
</p>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2021/01/06</div>
<h2><a href="/blog/20210106145700.html">Selenium::Firefox for JavaScript - enabled web scraping</a></h2>
<p>
  Let's do JavaScript-enabled web scraping with Selenium::Firefox. Selenium::Firefox is <a href="/blog/20210105145700.html">Selenium::Remote::Driver</a> customized for Firefox.
</p>
<pre>
# Generate driver. The following two are the same, but only work with Firefox 48+.
my $driver = Selenium::Firefox-&gt;new;
$driver = Selenium::Firefox-&gt;new(marionette_enabled =&gt; 1);
 
# Do something

# Shut down the driver
$driver-&gt;shutdown_binary;

# For Firefox 47 and if it's too old. Marionettes are disabled.
$driver = Selenium::Firefox-&gt;new(marionette_enabled =&gt; 0);
$driver-&gt;shutdown_binary; &lt;/pre&gt;
</pre>
<h3>Preparation of execution environment</h3>
<h4>For Mac</h4>
<p>
  <a href="https://sironekotoro.hateblo.jp/entry/2020/06/06/185455">Using Selenium from Perl</a> The environment construction procedure will be helpful.
</p>


  </div>
  <div class="bottom">
    <h3>Related Informatrion</h3>

<div style="margin:10px 10px;"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4525414114581084"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-4525414114581084"
     data-ad-slot="9163995495"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>

  </div>
</div>

        </div>
        <div class="side">
          <div style="margin-bottom:30px">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4525414114581084"
     crossorigin="anonymous"></script>
<!-- ディスプレイ縦長 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4525414114581084"
     data-ad-slot="4544919209"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>

<div class="side_list">
  <div class="side_list_body">
    <ul>
      <li>
        <div class="side_list_image">
          <a rel="nofollow" href="/list.html">New Articles</a><br>
          <a rel="nofollow" href="https://twitter.com/perlzemien">Updated Articles</a>
        </div>
      </li>
    </ul>
  </div>
</div>

        </div>
      </div>
      <div class="footer">
        <div class="perlri_link">
  <a rel="nofollow" href="https://perlclub.net/en">Perl Club</a>
</div>

      </div>
    </div>
  </body>
</html>
