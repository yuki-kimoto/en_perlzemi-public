<!DOCTYPE html>
<html>
  <head>
    <!-- Google Automatic Advertising -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4525414114581084"
     crossorigin="anonymous"></script>

<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">

<meta name="google-site-verification" content="4cR7WuQWEtkbu8ThfxGkT1vACiVi5Q_8ykfkRudOnTU" />

<link rel="shortcut icon" href="/images/logo.png">
<link rel="stylesheet" type="text/css" href="/css/common.css"><script type="text/javascript" src="/js/jquery-1.9.0.min.js"></script>
<script type="text/javascript" src="/js/google-code-prettify/prettify.js"></script>
<link  type="text/css" rel="stylesheet" href="/js/google-code-prettify/prettify.css"/>
<script>
  $(function(){
    $("pre").addClass("prettyprint");
    function init(event){
      prettyPrint();
    }
    if(window.addEventListener)window.addEventListener("load",init,false);
    else if(window.attachEvent)window.attachEvent("onload",init);
    
    $(".to-top").click(function() {
      $('body, html').animate({scrollTop: 0}, 300, 'linear');;
    });
  });
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HVBGQBWKJ2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HVBGQBWKJ2');
</script>

  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="header_main">
  <h1><a href="/"><img src="/images/logo.png">Perl ABC</a></h1>
</div>

      </div>
      <div class="main">
        <div class="content">
          <div class="entry">
  <div class="top">
    
  </div>
  <div class="middle">
    <div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2022/06/09</div>
<ol class = "bread" itemscope itemtype = "http://schema.org/BreadcrumbList">  <li itemprop = "itemListElement" itemscope itemtype = "http://schema.org/ListItem">    <a itemprop="item" href="/">        <span itemprop = "name">Perl </span></a>
    <meta itemprop = "position" content = "1" />
  </li>
  &#8250;
  <li itemprop = "itemListElement" itemscope itemtype = "http://schema.org/ListItem">    <a itemprop="item" href="/blog/20130416136637.html">      <span itemprop = "name">Perl Core</span></a>
    <meta itemprop = "position" content = "2" />
  </li>
  &#8250;
  <li>
    here
  </li>
</ol>
<h2><a href="/blog/20220609124939.html">The way to read Perl core source codes</a></h2>
<p>
  I explain the way to read Perl core source codes. <a href="https://github.com/Perl/perl5/tree/v5.36.0">Perl 5.36.0</a> is used in this description.
</p>
<h4>Where is main function?</h4>
<p>
  <code>main</code> function is the entry point of <code>perl</code> command.
</p>
<p>
  It is written in <code>perlmain.c</code>, but Perl has no C source code that name is <code>perlmain.c</code>.
</p>
<p>
  <code>perlmain.c</code> is generated by <a href="https://github.com/Perl/perl5/blob/v5.36.0/Makefile.SH#L802">Makefile.SH</a> using <a href="https://github.com/Perl/perl5/blob/v5.36.0/ext/ExtUtils-Miniperl/lib/ExtUtils/Miniperl.pm">ExtUtils::Miniperl</a>.
</p>
<h4>Where is processing perl command line arguments?</h4>
<p>
  Processing perl command line arguments are started from <a href="https://github.com/Perl/perl5/blob/v5.36.0/ext/ExtUtils-Miniperl/lib/ExtUtils/Miniperl.pm#L141">perl_parse</a> function.
</p>
<p>
  <code>perl_parse</code> is defined in <a href="https://github.com/Perl/perl5/blob/v5.36.0/perl.c#L1678">perl.c</a>.
</p>
<p>
  Go forward to <a href="https://github.com/Perl/perl5/blob/v5.36.0/perl.c#L1827">parse_body</a> function.
</p>
<p>
  <code>parse_body</code> is defined in <a href="https://github.com/Perl/perl5/blob/v5.36.0/perl.c#L2056">perl.c</a>
</p>
<p>
  You can see the processing logic of command line arguments.
</p>
<h4>Where is tokenizer?</h4>
<p>
  Next is the tokenizer. The parts of Perl syntax are converted to tokens.
</p>
<p>
  Tokenizing is started from <a href="https://github.com/Perl/perl5/blob/v5.36.0/perl.c#L2523">lex_start</a> function.
</p>
<p>
  <code>lex_start</code> is defined in <a href="https://github.com/Perl/perl5/blob/v5.36.0/toke.c#L809">toke.c</a>.
</p>
<h4>Where is parser?</h4>
<p>
  Next is the parser. The parser converts tokens to <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">AST</a>(abstruct syntax tree).
</p>
<p>
  Parsing is started from <a href="https://github.com/Perl/perl5/blob/v5.36.0/perl.c#L2536">yyparse</a> function.
</p>
<p>
  <code>yyparse</code> is defined in <a href="https://github.com/Perl/perl5/blob/v5.36.0/perly.c#L266">perly.c</a>.
</p>
<p>
  <code>perly.c</code> is generated from <a href="https://github.com/Perl/perl5/blob/v5.36.0/perly.y">perly.y</a> using <a href="https://en.wikipedia.org/wiki/GNU_Bison">bison</a>.
</p>
<h4>Where is Perl data structure?</h4>
<p>
  The type of the scalar value <code>SV</code> and its functions are defined in <a href="https://github.com/Perl/perl5/blob/v5.36.0/sv.h">sv.h</a> and <a href="https://github.com/Perl/perl5/blob/v5.36.0/sv.c">sv.c</a>.
</p>
<p>
  The type of the array <code>AV</code> and its functions are defined in <a href="https://github.com/Perl/perl5/blob/v5.36.0/av.h">av.h</a> and <a href="https://github.com/Perl/perl5/blob/v5.36.0/av.c">av.c</a>.
</p>
<p>
  The type of the hash <code>HV</code> and its functions are defined in <a href="https://github.com/Perl/perl5/blob/v5.36.0/hv.h">hv.h</a> and <a href="https://github.com/Perl/perl5/blob/v5.36.0/hv.c">hv.c</a>.
</p>
<h4>Where does Perl run?</h4>
<p>
  After AST is optimized, Perl run from <a href="https://github.com/Perl/perl5/blob/v5.36.0/ext/ExtUtils-Miniperl/lib/ExtUtils/Miniperl.pm#L142">perl_run</a> function.
</p>
<p>
  <code>perl_run</code> is defined in <a href="https://github.com/Perl/perl5/blob/v5.36.0/perl.c#L2621">perl.c</a>.
</p>
<p>
  Go forward to <a href="https://github.com/Perl/perl5/blob/v5.36.0/perl.c#L2644">run_body</a> function.
</p>
<p>
  <code>run_body</code> is defined in <a href="https://github.com/Perl/perl5/blob/v5.36.0/perl.c#L2678">perl.c</a>.
</p>
<p>
  Go forward to <a href="https://github.com/Perl/perl5/blob/v5.36.0/perl.c#L2721">CALLRUNOPS</a>.
</p>
<p>
  <code>CALLRUNOPS</code> is defined as <code>PL_runops</code> in <a href="https://github.com/Perl/perl5/blob/v5.36.0/perl.h#L228">perl.h</a>
</p>
<p>
  Furthermore, macros are defined as follows.
</p>
<pre>
perl.h:#define CALLRUNOPS  PL_runops
embedvar.h:#define PL_runops            (vTHX-&gt;Irunops)
intrpvar.h:PERLVARI(I, runops,  runops_proc_t, RUNOPS_DEFAULT)
perl.h:# define RUNOPS_DEFAULT Perl_runops_standard
</pre>
<p>
  Go forward to <code>Perl_runops_standard</code> function.
</p>
<p>
  <code>Perl_runops_standard</code> is defined in <a href="https://github.com/Perl/perl5/blob/v5.36.0/run.c#L37">run.c</a>.
</p>
<p>
  The member <a href="https://github.com/Perl/perl5/blob/v5.36.0/run.c#L41">op_ppaddr</a> of <code>OP</code> structure is called.
</p>
<p>
  <code>op_ppaddr</code> is a function pointer to perlform an operation.
</p>
<h4>Where are operators defined?</h4>
<p>
  Operators are defined in the following sources.
</p>
<ul>
  <li><a href="https://github.com/Perl/perl5/blob/v5.36.0/pp.c">pp.c</a></li>
  <li><a href="https://github.com/Perl/perl5/blob/v5.36.0/pp_ctl.c">pp_ctl.c</a></li>
  <li><a href="https://github.com/Perl/perl5/blob/v5.36.0/pp_hot.c">pp_hot.c</a></li>
  <li><a href="https://github.com/Perl/perl5/blob/v5.36.0/pp_pack.c">pp_pack.c</a></li>
  <li><a href="https://github.com/Perl/perl5/blob/v5.36.0/pp_sort.c">pp_sort.c</a></li>
  <li><a href="https://github.com/Perl/perl5/blob/v5.36.0/pp_sys.c">pp_sys.c</a></li>
</ul>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2022/05/30</div>
<h2><a href="/blog/20220530161828.html">Perl 5.36 is released - warnings enabled, subroutine signatures, try-catch-finally statements, Unicode 14 support</a></h2>
<p>
  Perl 5.36 was released on May 28, 2022. Enabling warnings, subroutine signatures, try-catch-finally statements, Unicode 14 support, and the functions to distinguish between booleans, strings, and numbers.
</p>
<h3>Use Perl 5.36 Features</h3>
<p>
  To use all the features of Perl 5.36, put the version declaration "use v5.36" at the beginning of the source code.
</p>
<pre>
use v5.36;
</pre>
<p>
  The version declaration should be written at the beginning of the source code. Otherwise, unexpected behavior may occur.
</p>
<h3>Enable Warnings</h3>
<p>
  The <a href="/blog/20130916137930.html">warnings module</a> is enabled by the version declaration.
</p>
<pre>
use warnings;
</pre>
<p>
  The <a href="/blog/20130912137895.html">strict module</a> is already enabled by the version declaration, so in Perl 5.36 the version declaration enables strict and warning.
</p>
<pre>
# From now
use strict;
use warnings;

# Perl 5.36+
use v5.36;
</pre>
<p>
  If <a href="http://blogs.perl.org/users/psc/2022/05/what-happened-to-perl-7.html">Perl 7</a> is released in the future, you can omit the minor version:
</p>
<pre>
use v7;
</pre>
<h3>Subroutine signature is no longer experimental</h3>
<p>
  Subroutine signature is no longer experimental and is enabled by the version declaration. Subroutine signature is the feature to write arguments after a subroutine name.
</p>
<pre>
use v5.36;

sub add ($x, $y) {
  return $x + $y;
}
</pre>
<p>
  You can write subroutines as follows.
</p>
<pre>
# From now
sub add ($x, $y) {
  my ($x, $y) = @_;
  
  $y = 3 unless defined $y;
  
  return $x + $y;
}

# v5.36
sub add ($x, $y = 3) {
  return $x + $y;
}
</pre>
<p>
  Note that a subroutine signature checkes the number of arguments. If there are few or many arguments given, an exception will be thrown.
</p>
<p>
  If you want to disable the number of arguments check, please write as follows.
</p>
<pre>
sub add ($x, $y, @) {
  return $x + $y;
}
</pre>
<h3>Experimental try-catch-finally Statement</h3>
<p>
  You can use experimental try-catch-finally statement.
</p>
<pre>
use feature'try';

try {
  
}
catch ($e) {
  
}
finally {
  
}
</pre>
<h3>"-g" Command Line Flag</h3>
<p>
  An option "-g" is added to the perl command. This option reads a whole file .
</p>
<pre>
perl -n -g -E'if (m | &lt;h1&gt; (. *?)&lt;/h1&gt; |) {say $1;}' a.html
</pre>
<p>
  Previously, Perl do the same thing using the option "-0777", but this feature is used so often, an easy way is added.
</p>
<pre>
perl -n -0777 -E'if (m | &lt;h1&gt; (. *?)&lt;/h1&gt; |) {say $1;}' a.html
</pre>
<h3>Unicode 14.0 Support</h3>
<p>
  <a href="https://gigazine.net/news/20210916-unicode-14-emoji/">Unicode 14.0</a> is now supported.
</p>
<h3>builtin Namespace</h3>
<p>
  Experimentally "builtin" namespace is added for standard functions. Perl can add functions without worrying about name clashes.
</p>
<pre>
my $true = builtin::true;

use builtin 'true';

my $true = true;
</pre>
<p>
  All functions in the builtin namespace are currently experimental.
</p>
<h3>true Function, false Function, and is_bool Function</h3>
<p>
  "builtin::true" and "builtin::false" functions are added to represent boolean values.
</p>
<pre>
# True
builtin::true;

# False
builtin::false;
</pre>
<p>
  "builtin::true" is equal to "!!1" and builtin::false is equal to "!!0".
</p>
<p>
  You can check the boolean value with "builtin::is_bool" function.
</p>
<pre>
if (builtin::is_bool $bool) {
  
}
</pre>
<p>
  This is useful when generating JSON.
</p>
<h3> You can distinguish between numbers and strings</h3>
<p>
  In Perl 5.36, you can use the "builtin::created_as_number" and "builtin::created_as_string" functions to distinguish between numbers and strings. It is supposed to be used in serializers such as JSON.
</p>
<pre>
if (builtin::created_as_number $data) {
  
}

if (builtin::created_as_string $data) {
  
}
</pre>
<p>
  The combination with "builtin::is_bool" allows correct JSON serialization and deserialization using only the Perl core functions.
</p>
<pre>
if (builtin::is_bool $data) {
  
}
eleif (builtin::created_as_number $data) {
  
}
elsif (builtin::created_as_string $data) {
  
}
</pre>
<h3>builtin::trim Function</h3>
<p>
  A builtin::trim function is added. You can remove the leading and trailing spaces.
</p>
<pre>
my $trim = builtin::trim $string;
</pre>
<h3> Iterating multiple elements</h3>
<p>
  The "for" statement supports the iteratating multiple elements. This feature is experimental.
</p>
<pre>
for my ($key, $value) (%hash) {...}
for my ($left, $right, $grinding) (@moties) {...}
</pre>
<h3>How to install Perl 5.36 quickly?</H3>
<p>
  <a href="/blog/20110220130464.html"> perlbrew</a> or <a href="/blog/20180816153437.html"> plenv</a> is easy ways to install Perl 5.36.
</p>
<p>
  <b> perlbrew</b>
</p>
<pre>
perlbrew install perl-5.36.0
</pre>
<p>
  <b> plenv</b>
</p>
<pre>
plenv install 5.36.0
</pre>
<h3> See all changes</h3>
<p>
  See perldelta to see all the changes.
</p>
<p>
  <a href="https://metacpan-org.translate.goog/release/RJBS/perl-5.36.0/view/pod/perldelta.pod?_x_tr_sl=en&_x_tr_tl=ja&_x_tr_hl=ja&_x_tr_pto=wapp"> perldelta</a>
</p>
<p>
  You can past release information.
</p>
<p>
  <a href="/blog/20160225145640.html">Perl Release Information</a>
</p>
<h3>My Comments</h3>
<p>
  Congratulations on the release of Perl 5.36! Thank you to all the developers.
</p>
<p>
  "use warnings" is enabled by the version declaration. I want to use the version declaration more.
</p>
<p>
  I want to use "for" syntax that iterates multiple elements.
</p>
<p>
  The "-g" option makes one-liner easier.
</p>
<p>
  "trim" seems to be used frequently.
</p>
<p>
  It is very good to be able to distinguish between strings, numbers and booleans.
</p>
<p>
  Checking the number of arguments in a subroutine signature is a bit worrisome when used in a production environment for products that require high reliability, as it raises unexpected run-time exceptions.
</p>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2022/04/26</div>
<h2><a href="/blog/20220426170406.html">Installing Strawberry Perl using Chocolatey</a></h2>
<p>
  If you use <a href="https://docs.chocolatey.org/en-us/">Chocolatey</a>, you can install <a href="/blog/20180808153368.html">Strawberry Perl</a> from <a href="https://en.wikipedia.org/wiki/Command-line_interface">CLI</a>.
</p>
<h3>Installing Chocolatey</h3>
<p>
  Let's install Chocolatey. Chocolatey is a CLI tool to manage applications on Windows.
</p>
<p>
  See also official <a href="https://docs.chocolatey.org/en-us/choco/setup">SETUP / INSTALL of Chocolatey</a>.
</p>
<h4>Command Prompt</h4>
<p>
  Install Chocolatey using <a href="/blog/20080603121251.html">Command Prompt</a>.
</p>
<pre>
@"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "[System.Net.ServicePointManager]::SecurityProtocol = 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))" &amp;&amp; SET "PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin"
</pre>
<h4>PowerShell</h4>
<p>
  Install Chocolatey using <a href="/blog/20220420170117.html">PowerShell</a>.
</p>
<pre>
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))
</pre>
<h3>Installing Strawberry Perl using Chocolatey</h3>
<p>
  Install Strawberry Perl using Chocolatey.
</p>
<pre>
choco install strawberryperl
</pre>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2022/04/20</div>
<h2><a href="/blog/20220420170117.html">PowerShell(pwsh) Tutorial for Perl</a></h2>
<ol class = "bread" itemscope itemtype = "http://schema.org/BreadcrumbList">  <li itemprop = "itemListElement" itemscope itemtype = "http://schema.org/ListItem">    <a itemprop="item" href="/">        <span itemprop = "name">Perl </span></a>
    <meta itemprop = "position" content = "1" />
  </li>
  &#8250;
  <li itemprop = "itemListElement" itemscope itemtype = "http://schema.org/ListItem">      <span itemprop = "name">here </span>
    <meta itemprop = "position" content = "2" />
  </li>
</ol>
<p>
  PowerShell(pwsh) is a <a href="https://en.wikipedia.org/wiki/Command-line_interface">CLI</a> tool to run programs on Windows. 
</p>
<h3>Features of PowerShell(pwsh)</h3>
<ul>
  <li>UTF-8</li>
  <li>Linux/UNIX-like Shell</li>
  <li>ls, echo commands, etc</li>
  <li>A string is quoted "" and ''</li>
</ul>
<h3>Installation of PowerShell(pwsh)</h3>
<p>
  PowerShell(pwsh) can be downloaded from the following page.
</p>
<p>
  <a href="https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7#installing-the-msi-package">Installing PowerShell on Windows</a>
</p>
<p>
  Click the following link to download PowerShell(pwsh).
</p>
<p>
  <a href="https://github.com/PowerShell/PowerShell/releases/download/v7.2.2/PowerShell-7.2.2-win-x64.msi"!>PowerShell-7.2.2-win-x64.msi</a>
</p>
<p>
  And double-click the downloaded file. The installer is executed.
</p>
<p>
  "Next" | "Next" | "Next" | "Install" | "Finish"
</p>
<h3>Execution of PowerShell/pwsh</h3>
<p>
  Let's execute PowerShell/pwsh.
</p>
<p>
  "Start Menu" | "Apps" | "PowerShell" | "PowerShell 7 (x64)"
</p>
<p>
  <img src="/images/installation/pwsh.png">
</p>
<p>
  Your home directory is shown on PowerShell/pwsh.
</p>
<pre>
PS C:\Users\kimot
</pre>
<h3>Showing File Extensions</h3>
<p>
  The extension of Perl program is "<b>.pl</b>". It is useful if extensions of files are displayed.
</p>
<p>
  The way to show file extensions is described in the following page.
</p>
<p>
  <a href="https://www.howtogeek.com/205086/beginner-how-to-make-windows-show-file-extensions/">How to Make Windows Show File Extensions</a>
</p>
<h3>Execution of Notepad</h3>
<p>
  Perl programs are text files. You can create your Perl programs using Notepad.
</p>
<p>
  The way to use Notepad is described in the following page.
</p>
<p>
  <a href="https://www.digitalcitizen.life/start-notepad-windows/">11 ways to start Notepad in Windows</a>
</p>
<h3>Creating Perl Programs</h3>
<p>
  Let's create a Perl program.
</p>
<p>
  Create a file named "start.pl" at your home directory.
</p>
<pre>
C:\Users\kimot\start.pl
</pre>
<p>
  And write the following text.
</p>
<pre>
print "Hello World";
</pre>
<p>
  And save it.
</p>
<h3>Running Perl Programs</h3>
<p>
  You can run your Perl program using <b>perl</b> command.
</p>
<pre>
perl start.pl
</pre>
<p>
  The output is:
</p>
<pre>
Hello World
</pre>
<h3>Commands of PowerShell/pwsh</h3>
<p>
  Introdule often used commands of PowerShell/pwsh.
</p>
<h4>ls</h4>
<p>
  The "ls" command displays the list of files.
</p>
<pre>
ls
</pre>
<h4>cd</h4>
<p>
  The "cd" command changes the working directory.
</p>
<pre>
cd DirectoryName
</pre>
<p>
  ".." is the file name that means the folder one level higher.
</p>
<pre>
cd ..
</pre>
<h4>Changing Drives</h4>
<p>
  You can change drives using "c:" or "d:".
</p>
<pre>
Set-Location -Path c:
Set-Location -Path d:
</pre>
<h4>Seeing Command Histories</h4>
<p>
  You can see command histories using "↑" and "↓" keys.
</p>
<pre>
↑
↓
</pre>
<h3>Show Environment Variables</h3>
<p>
  Show environment variables.
</p>
<pre>
ls env:
</pre>
<h4>Getting Environment Variables</h4>
<p>
  You can get and show an environment variable as the following.
</p>
<pre>
echo $env:PATH
</pre>
<p>
  $env:MYENV = "This is my env."
</p>
<h4>Setting Environment Variable</h4>
<p>
  You can set an environment variable as the following.
</p>
<pre>
$env:DATE=20080604
</pre>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2022/04/18</div>
<h2><a href="/blog/20220418170733.html">Installing Perl on WSL 2</a></h2>
<p>
  <a href="https://docs.microsoft.com/en-us/windows/wsl/install">WSL 2</a> is Windows Subsystem for Linux. You can install Linux on Windows using WSL 2. And you can use Perl.
</p>
<p>
  <img style = "border: 1px solid # ddd; max-width: 600px;" src = "/images/installation/wsl2.png">
</p>
<h3>Installing WSL 2</h3>
<p>
  Let's intall WSL 2. Run the following command on <a href="/blog/20080603121251.html">Windows Command Prompt</a>.
</p>
<pre>
# Install WSL 2
wsl --install
</pre>
<p>
  <a href="https://en.ubuntu.perlzemi.com/">Ubuntu</a> is installed by default.
</p>
<p>
  Reboot Windows to enable WSL2.
</p>
<p>
  Take a few minutes.
</p>
<p>
  You see the following messages.
</p>
<h4>User Name</h4>
<pre>
Installing, this may take a few minutes...

Please create a default UNIX user account. The username does not need to match your Windows username.
For more information visit: https://aka.ms/wslusers
Enter new UNIX username:
</pre>
<p>
  I enter the following user name as an example.
</p>
<pre>
kimoto_ubuntu
</pre>
<p>
  By right-clicking on Ubuntu terminal, you can paste the user name.
</p>
<h4>Password</h4>
<p>
  Next, set password.
</p>
<p>
  The setup of Ubuntu is completed.
</p>
<h3>Boot Ubuntu</h3>
<p>
  Let's boot Ubuntu.
</p>
<p>
  "Start Menu" | "Ubuntu"
</p>
<h3>Checking the installation of Perl</h3>
<p>
  Perl is installed by default on Ubuntu. Let's check the installation of Perl.
</p>
<pre>
perl -v
</pre>
<p>
  The version of Perl is displayed.
</p>
<pre>
This is perl 5, version 30, subversion 0 (v5.30.0) built for x86_64-linux-gnu-thread-multi
</pre>
<h3>Show files using Explore</h3>
<p>
  You can see files on Ubuntu by the following path. <b>\\wsl$</b> is root directory of WSL 2.
</p>
<pre>
\\wsl$\Ubuntu\home\kimoto_ubuntu
</pre>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2022/01/14</div>
<h2><a href="/blog/20220114172658.html">How to create the Cover of Amazon Kindle Paperback using Perl?</a></h2>
<p>
  Describe how to create the Cover of Amazon Kindle Paperback using Perl? Perl is a programing language. You can create the the cover image of Amazon Kindle Paperback using Perl module <a href="https://metacpan.org/pod/Imager">Imager</a>.
</p>
<p>
  I assume you have an ebook cover. Based on this, you will create the paperback cover. In this example, I use A5(148 x 210 mm).
</p>
<p>
  <img src="/images/kindle_paperback/ebook_coloer.jpg" style="width:200px">
</p>
<h3>Create a Paperback Cover - Amazon Kindle Officail</h3>
<p>
  At first, you see the Amazon Kindle Officail page "Create a Paperback Cover".
</p>
<ul>
  <li><a href="https://kdp.amazon.com/en_US/help/topic/G201953020">Create a Paperback Cover</a></li>
</ul>
<p>
  You will find the following page "Print Cover Calculator and Templates".
</p>
<ul>
  <li><a href="https://kdp.amazon.com/cover-calculator">Create a Paperback Cover</a></li>
</ul>
<p>
  You must calcurate the size of the cover image using the tool "Print Cover Calculator and Templates".
</p>
<h3>Enter Your Book Information</h3>
<p>
  <b>Binding type</b>
</p>
<p>
  Paperback
</p>
<p>
  <b>Interior type</b>
</p>
<p>
  Choice the one of them you want.
</p>
<ul>
  <li>
    Black & White
  </li>
  <li>
    Premiam Color
  </li>
  <li>
    Standard Color
  </li>
</ul>
<p>
  <b>Paper type</b>
</p>
<p>
  White paper
</p>
<p>
  <b>Page-turn direction</b>
</p>
<p>
  Choice the one of them you want.
</p>
<ul>
  <li>
    Left to Right
  </li>
  <li>
    Right to Left
  </li>
</ul>
<p>
  <b>Measurement units</b>
</p>
<p>
  Millimeters.
</p>
<p>
  <b>Interior trim size</b>
</p>
<p>
  Custom trim size. In this example, A5(148mm x 210 mm) size.
</p>
<p>
  148mm 210mm
</p>
<p>
  <b>Page count</b>
</p>
<p>
  Calcurate the page count of your book.
</p>
<pre>
page_count = body_page_count + cover_page_count.
</pre>
<p>
  body_page_count is the page count of your PDF book.
</p>
<p>
  cover_page_count is the page count of the color. This is always 4p.
</p>
<pre>
# Example:
120p = 116p + 4p
</pre>
<p>
  (Uncompeted)
</p>

<div style="font-weight:bold;font-size:18px;letter-spacing:2px;margin:35px 0 0px 0;padding-left:5px;padding-top:5px;border-top:2px solid #ddd">2021/11/19</div>
<h2><a href="/blog/20211119124656.html">JavaScript Supported Web Scraping using Perl and Selenium</a></h2>
<p>
  I explain JavaScript supported web scraping using Perl and <a href="https://metacpan.org/pod/Selenium::Remote::Driver">Selenium::Remote::Driver</a>. Selenium::Remote::Driver is a Perl module for Selenium. Selenium provides the APIs for JavaScript supported web scraping. 
</p>
<h3>Download and Install Perl</h3>
<p>
  See the following articles about how to donwload and install Perl. Windows, Max, Linux/UNIX are supported.
</p>
<ul>
  <li><a href="/blog/20180820153471.html">Download and Install Perl</a></li>
</ul>
<h3>Download and Install Google Chrome</h3>
<p>
  I explain the way to install web browsers.
</p>
<h4>Windows and Mac</h4>
<p>
  You can download and install Google Chrome in the following page.
</p>
<ul>
 <li><a href="https://www.google.com/chrome/">Google Chrome - Download</a></li>
</ul>
<h4>Linux</h4>
<p>
  In Linux you maybe install Google Chrome using package managers. I try the installing Google Chrome on the some Linux distributions.
</p>
<h5>Ubuntu</h5>
<ul>
 <li><a href="https://en.ubuntu.perlzemi.com/blog/20211117083934.html">Install Google Chrome on Ubuntu</a></li>
</ul>
<h5>CentOS</h5>
<ul>
 <li><a href="https://en.centos.perlzemi.com/blog/20210104090837.html">Install Google Chrome on CentOS</a></li>
</ul>
<h4>Check the version of Google Chrome</h4>
<p>
  Check the version of Google Chrome.
</p>
<pre>
google-chrome --version
</pre>
<p>
  An example of the output:
</p>
<pre>
Google Chrome 87.0.4280.88
</pre>
<h3>Download and Install ChromeDriver</h3>
<p>
  ChromeDriver is a web driver. Web drivers is tools to control Web browsers by using programs.
</p>
<h5>Ubuntu</h5>
<ul>
 <li><a href="https://en.ubuntu.perlzemi.com/blog/20211116083934.html">Install ChromeDriver on Ubuntu</a></li>
</ul>
<h5>CentOS</h5>
<ul>
 <li><a href="https://en.centos.perlzemi.com/blog/20210103090837.html">Install ChromeDriver on CentOS</a></li>
</ul>
<h4>Check the version of ChromeDriver</h4>
<p>
  Check the version of ChromeDriver.
</p>
<pre>
chromedriver --version
</pre>
<p>
  An example of the output:
</p>
<pre>
ChromeDriver 87.0.4280.88 (89e2380a3e36c3464b5dd1302349b1382549290d-refs/branch-heads/4280@{#1761})
</pre>
<p>
  It is good that the version of ChromeDriver is the same as Google Chrome to prevent problems.
</p>
<h3>Install Selenium::Remote::Driver</h3>
<p>
  Let's install <a href="https://metacpan.org/pod/Selenium::Remote::Driver">Selenium::Remote::Driver</a> using <a href="/blog/20101027127859.html">cpanm</a> or <a href="/blog/20100504127089.html">cpan</a>. Selenium::Remote::Driver is a Perl module for Selenium.
</p>
<pre>
# cpanm
cpanm Selenium::Remote::Driver

# cpan
cpan Selenium::Remote::Driver
</pre>
<h3>Get a Web Page using Selenium</h3>
<p>
  Get a Web Page using Selenium.
</p>
<h4>Load Selenium::Chrome</h4>
<p>
  Let's load <b>Selenium::Chrome</b>. Selenium::Chrome is a sub class of Selenium::Remote::Driver for Google Chrome.
</p>
<pre>
use Selenium::Chrome;
</pre>
<h4>Create a Selenium::Chrome Object</h4>
<p>
  Create a Selenium::Chrome object with headless options. 
</p>
<pre>
my $driver = Selenium::Chrome-&gt;new(
  extra_capabilities =&gt; {
    'goog:chromeOptions' =&gt; {
      args =&gt; ['headless', 'disable-gpu', 'window-size=1920,1080', 'no-sandbox' ]
    }
  }
);
</pre>
<p>
  <b>new</b> method is a constructor of normal <a href="https://en.perlzemi.com/blog/20161030147778.html">Perl Objcet Oriented Programing</a>. Options is specified using <a href="https://en.perlzemi.com/blog/20180208151809.html">Hash References</a> and <a href="https://en.perlzemi.com/blog/20180214151861.html">Array References</a>
</p>
<p>
  These options is needed for headless execution. Headless execution means you get a page without the GUI of Google Chrome.
</p>
<p>
  If there are no these options and you don't have GUI display, you will see the following error message.
</p>
<pre>
Could not create new session: unknown error: Chrome failed to start: exited abnormally.

(unknown error: DevToolsActivePort file doesn't exist) (The process started from chrome location /usr/bin/google-chrome is no longer running, so ChromeDriver is assuming that Chrome has crashed.) at access.pl line 79.
</pre>
<h4>Shutdown a Selenium::Chrome Object</h4>
<p>
  If you finish the use of Selenium::Chrome, you need to shutdown it.
</p>
<pre>
$driver-&gt;shutdown_binary;
</pre>
<h4>Get a Web Page and the Title</h4>
<p>
  You can get a web page using a <b>get</b> method.
</p>
<pre>
$driver-&gt;get('http://www.google.com');
</pre>
<p>
  It is good to wait for a few seconds because the page is maybe not yet rendered.
</p>
<pre>
sleep 3;
</pre>
<p>
  You can get the title using a <b>get_title</b> method.
</p>
<pre>
my $title = $driver-&gt;get_title;
</pre>
<p>
  <b>Examples:</b>
</p>
<p>
  This is an example to get a page and the title.
</p>
<pre>
use Selenium::Chrome;

# Create a Selenium::Chrome object
my $driver = Selenium::Chrome-&gt;new(
  extra_capabilities =&gt; {
    'goog:chromeOptions' =&gt; {
      args =&gt; ['headless', 'disable-gpu', 'window-size=1920,1080', 'no-sandbox' ]
    }
  }
);

# Get a page
$driver-&gt;get('http://www.google.com');

sleep 3;

# Get the title
my $title = $driver-&gt;get_title;

print "$title\n";

# Shutdown
$driver-&gt;shutdown_binary;
</pre>
<p>
  The output:
</p>
<pre>
Google
</pre>
<h4>Get the Screenshot</h4>
<p>
  You can get the screenshot using <b>capture_screenshot</b> method.
</p>
<pre>
$driver-&gt;capture_screenshot("screenshot.png");
</pre>
<p>
  If you want to save the screenshot to the program directory, you can use <a href="/blog/20100524127696.html">FindBin</a> module.
</p>
<pre>
use FindBin;

$driver-&gt;capture_screenshot("$FindBin::Bin/screenshot.png");
</pre>
<p>
  If you want to serve the screenshot file and see it on your web browser, you can use <a href="https://metacpan.org/pod/Mojolicious::Plugin::Directory">Mojolicious::Plugin::Directory</a> or <a href="https://metacpan.org/pod/Mojolicious::Plugin::Directory::Stylish">Mojolicious::Plugin::Directory::Stylish</a>.
</p>
<p>
  <b>Mojolicious::Plugin::Directory</b>
</p>
<pre>
# Insltall
cpanm Mojolicious::Plugin::Directory

# Serve current directories on your command line
perl -Mojo -E 'a-&gt;plugin("Directory")-&gt;start' daemon
</pre>
<p>
  <b>Mojolicious::Plugin::Directory::Stylish</b>
</p>
<pre>
# Insltall
cpanm Mojolicious::Plugin::Directory::Stylish

# Serve current directories on your command line
perl -Mojo -E 'a-&gt;plugin("Directory::Stylish")-&gt;start' daemon
</pre>
<h3>Install Fonts</h3>
<p>
  If you see character corruption when you get screenshots, the installing of fonts is needed.
</p>
<p>
  I explain the way to install the fonts on some OSs.
</p>
<h4>Ubuntu</h4>
<ul>
  <li><a href="https://en.ubuntu.perlzemi.com/blog/20211124125149.html">Install Fonts on Ubuntu</a></li>
</ul>
<h4>CentOS</h4>
<ul>
  <li><a href="https://en.centos.perlzemi.com/blog/20211124121003.html">Install Fonts on CentOS</a></li>
</ul>
<h3>CSS Selector</h3>
<p>
  If you are familiar with CSS Selector, you can make CSS Selector as the default finder.
</p>
<pre>
# Make CSS Selector as the default finder
$driver-&gt;default_finder('css');
</pre>
<p>
  In this page, I use CSS selector to select elements of HTML.
</p>
<h3>Get An Element</h3>
<p>
  You can get an element using <b>find_element</b> method with CSS selector. The return value is <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>
</p>
<pre>
# Get an element using id CSS selector
my $element = $driver-&gt;find_element("#myid");

# Get an element using class CSS selector
my $element = $driver-&gt;find_element(".myclass");

# Get an element using attirbute CSS selector
my $element = $driver-&gt;find_element("[name=id]");
</pre>
<p>
  Note that <b>find_element</b> method throws exception when the element is not found.
</p>
<p>
  If you want to avoid exceptions, you need to use <a href="/blog/20100312126967.html">eval</a> block.
</p>
<pre>
my $element;
eval {
  $element = $driver-&gt;find_element("#myid");
};
</pre>
<h4>Often Used CSS Selectors</h4>
<p>
  I introduce often used CSS selectors.
</p>
<pre>
# id starts with "myid_"
my $selects_first = $driver-&gt;find_element('[id^=myid_]');
</pre>
<h4>Get a Child Element</h4>
<p>
  If you get a child element of the element, you can use <b>find_child_element</b> method.
</p>
<pre>
# Get a child elemen
my $child_element = $driver-&gt;find_child_element($element, ".myclass");
</pre>
<h3>Get Multiple Elements</h3>
<p>
  You can get multiple elements using <b>find_elements</b> method with CSS selector. The return value is an <a href="https://en.perlzemi.com/blog/20180214151861.html">Array References</a> which contains the list <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<p>
  In this example, I get the button that contains "Signin" using <a href="https://en.perlzemi.com/blog/20161023147731.html">if statement</a> and <a href="https://en.perlzemi.com/blog/20170521149524.html">for statement</a> and <a href="https://en.perlzemi.com/blog/20100827127859.html">Regular Expressions</a>.
</p>
<pre>
# Get Multiple Elements
my $buttons = $driver-&gt;find_elements('button');
for my $button (@$buttons) {
  my $text = $button-&gt;get_text;
  if ($text =~ /Signin/) {
    $button-&gt;click;
  }
}
</pre>
<p>
  Note that <b>find_elements</b> method throws exception when all the elements is not found.
</p>
<p>
  If you want to avoid exceptions, you need to use <a href="/blog/20100312126967.html">eval</a> block.
</p>
<pre>
my $buttons;
eval {
  $buttons = $driver-&gt;find_elements('button');
};
</pre>
<h4>Get Child Elements</h4>
<p>
  If you get child elements of the element, you can use <b>find_child_elements</b> method.
</p>
<pre>
# Get a child elemen
my $child_elements = $driver-&gt;find_child_elements($element, ".myclass");
</pre>
<h3>Text Fields, Password Fields, Text Area</h3>
<p>
  I explain the manipulation of text fields, password fields, text areas.
</p>
<h4>Input Text</h4>
<p>
  You can input text in text fields, password fields, text areas using <b>send_keys</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>. Text are <a href="https://en.perlzemi.com/blog/20161003147558.html">Perl Strings</a>.
</p>
<pre>
# Input text
$input_element-&gt;send_keys("perlclub");
</pre>
<p>
  <b>send_keys</b> method supports Unicode. You need to write "use utf8;" and save the source code as UTF-8.
</p>
<pre>
# Input unicode text
use strict;
use warnings;
use utf8;

# ...

$input_element-&gt;send_keys("あいうえお");
</pre>
<h3>Input Keys from Keybord</h3>
<p>
  I explain the details of input keys from keybord.
</p>
<h4>Input Characters</h4>
<p>
  You can input keys to an element using <b>send_keys</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Input text
$element-&gt;send_keys("perlclub");
</pre>
<h4>Input Unicode Characters</h4>
<p>
  <b>send_keys</b> method supports Unicode. You need to write "use utf8;" and save the source code as UTF-8.
</p>
<pre>
# Input unicode text
use strict;
use warnings;
use utf8;

# ...

$element-&gt;send_keys("あいうえお");
</pre>
<h4>Input Special Keys</h4>
<p>
  You can input special keys such as "space", "enter" using <b>send_keys</b> method with <b>KEYS</b> function <a href="https://metacpan.org/pod/Selenium::Remote::WDKeys">Selenium::Remote::WDKeys</a>.
</p>
<pre>
use Selenium::Remote::WDKeys;

# ...

# Input space
$element-&gt;send_keys(KEYS-&gt;{'space'});

# Input enter
$element-&gt;send_keys(KEYS-&gt;{'enter'});

# Input "up arrow" x 10
$element-&gt;send_keys(KEYS-&gt;{'up_arrow'} x 10);

# Input "down arrow" x 5
$element-&gt;send_keys(KEYS-&gt;{'down_arrow'} x 5);
</pre>
<p>
  The following is the list of constant keys.
</p>
<pre>
null
cancel
help
backspace
tab
clear
return
enter
shift
control
alt
pause
escape
space
page_up
page_down
end
home
left_arrow
up_arrow
right_arrow
down_arrow
insert
delete
semicolon
equals
numpad_0
numpad_1
numpad_2
numpad_3
numpad_4
numpad_5
numpad_6
numpad_7
numpad_8
numpad_9
multiply
add
separator
subtract
decimal
divide
f1
f2
f3
f4
f5
f6
f7
f8
f9
f10
f11
f12
command_meta
ZenkakuHankaku
</pre>
<h3>Checkbox and Radio Button</h3>
<p>
  I explain how to check the chekking of checkboxes and radio buttons and set the chekking of checkboxes and radio buttons.
</p>
<h4>Check the Chekking of Checkboxes and Radio Buttons</h4>
<p>
  You can check the checking of checkboxes or radio buttons using <b>is_selected</b> method of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Check the Chekking of Checkboxes or Radio Buttons
my $is_selected = $element-&gt;is_selected;
</pre>
<h4>Set the Chekking of Checkboxes or Radio Buttons</h4>
<p>
  You can set the chekking of checkboxes or radio buttons <b>set_selected</b> method of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Set the Chekking of Checkboxes or Radio Buttons
$element-&gt;set_selected;
</pre>
<p>
  You maybe see the following error "Other element would receive the click".
</p>
<pre>
Error while executing command: element click intercepted: element click intercepted: Element &lt;input type="checkbox" class="myclass" value="true" id="myid"&gt; is not clickable at point (1009, 210). Other element would receive the click: &lt;label class="mylabel" for="myid"&gt;...&lt;/label&gt;
  (Session info: headless chrome=87.0.4280.88) at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 410.
 at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 361.
</pre>
<p>
  This is because label block receive the click in the logic of <b>set_selected</b> method.
</p>
<p>
  You can write the following codes to click the label. The label block is a sibling of #myid
</p>
<pre>
my $checkbox = $driver-&gt;find_element("#myid");
unless ($checkbox-&gt;is_selected) {
  my $checkbox_label = $driver-&gt;find_element("#myid ~ label");
  $checkbox_label-&gt;set_selected;
}
</pre>
<h3>Click Buttons</h3>
<p>
  You can click buttons using <b>click</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Click Buttons
$button-&gt;click;
</pre>
<p>
  You maybe see the following error "is not clickable".
</p>
<pre>
...&lt;button&gt;...&lt;/button&gt; is not clickable ... at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 410.
 at /home/perlclub/perl5/perlbrew/perls/perl-5.20.3/lib/site_perl/5.20.3/Selenium/Remote/Driver.pm line 361.
</pre>
<p>
  Note that the clicked button is needed to be displayed.
</p>
<p>
  You can scroll the windows to display the button in the middle of the window using <b>execute_script</b> method and JavaScript's <b>scrollIntoView</b> method.
</p>
<pre>
# Display the button in the middle of the window
$driver-&gt;execute_script('arguments[0].scrollIntoView({block: "center"});', $button);

# Click Buttons
$button-&gt;click;
</pre>
<h4>Examples to click buttons</h4>
<p>
  Click the button that text is "Search".
</p>
<pre>
# Click the button that text is "Search".
my $buttons = $driver-&gt;find_elements('button');
for my $button (@$buttons) {
  my $text = $button-&gt;get_text;
  if ($text =~ /^\s*Search\s*$/) {
    $button-&gt;click;
    last;
  }
}
</pre>
<h3>Get Text</h3>
<p>
  You can get text of an element using <b>get_text</b> method  of <a href="https://metacpan.org/pod/Selenium::Remote::WebElement">Selenium::Remote::WebElement</a>.
</p>
<pre>
# Get text
my $text = $element-&gt;get_text;
</pre>
<p>
  If you click buttons, you maybe wait a few seconds until the next page is shown using <a href="https://en.perlzemi.com/blog/20170522149546.html">sleep</a> function.
</p>
<pre>
sleep 3;
</pre>
<h3>Execute JavaScript</h3>
<p>
  You can execute JavaScript using <b>execute_script</b> method. The first argument is JavaScript you want to execute. The second argument is an element. This elemenet is passed to the first argument of <b>arguments</b> variable of JavaScript.
</p>
<pre>
$driver-&gt;execute_script('arguments[0].scrollIntoView({block: "center"});', $button);
</pre>
<p>
  If you can't found operations you want to execute in the Selenium::Remote::Driver documents, you can execute any JavaScript using <b>execute_script</b> method.
</p>
<h3>Select Fields</h3>
<p>
  I explain how to select the value of Select Fields. 
</p>
<p>
  1. Display the select field
</p>
<p>
  2. Click the select field.
</p>
<p>
  3. Input down keys
</p>
<p>
  4. Input enter key
</p>
<pre>
# Display the select field
$driver-&gt;execute_script('arguments[0].scrollIntoView({block: "center"});', $select);

# Click the select field
$select-&gt;click;

# Input down keys
$select-&gt;send_keys(KEYS-&gt;{'down_arrow'} x $key_down_count);

# Input enter key
$select-&gt;send_keys(KEYS-&gt;{'enter'});
</pre>
<p>
  "x" is a <a href="https://en.perlzemi.com/blog/20180227151973.html">Perl Repeat Operator</a>.
</p>
<h3>Get Page Source</h3>
<p>
  You can get the page source that is parsed after the web browser using <b>get_page_source</b> method. This is not a pure raw page source.
</p>
<pre>
# Get the page source
my $page_source = $driver-&gt;get_page_source;
</pre>
<h3>Get body Text</h3>
<p>
  You can get the text in the body tag using <b>get_body</b> method. The return value doesn't contain HTML tags, only contains text.
</p>
<pre>
# Get the body text
my $body_text = $driver-&gt;get_body;
</pre>
<h3>Table Manipulation</h3>
<p>
  I introduce examples of table manipulation to iterate each row of the table.
</p>
<pre>
# Table manipulation
my $rows;
eval { $rows = $driver-&gt;find_elements('table.mytable &gt; tr') };
if ($rows) {
  for my $row (@$rows) {
    my $row_text = $row-&gt;get_text;
    if ($row_text =~ /\b(\d{12})\b/a) {
      my $id = $1;
      
      print "$id\n";
    }
  }
}
</pre>
<h3>Donwload Files</h3>
<p>
  I explain how to donwload files using Selenium::Chrome.
</p>
<h4>Set the Download Directory</h4>
<p>
  You can set the download directory using C<prefs> option of <b>new</b> method of Selenium::Chrome.
</p>
<pre>
my $driver = Selenium::Chrome-&gt;new(
  extra_capabilities =&gt; {
    'goog:chromeOptions' =&gt; {
      args =&gt; ['headless', 'disable-gpu', 'window-size=1920,1080', 'no-sandbox' ],
      prefs =&gt; {
          'download.default_directory' =&gt; '/tmp'
      },
    }
  }
);
</pre>
<p>
  Note that you can't specify home direcitories as download directories for security reasones.
</p>
<h4>Download Files</h4>
<p>
  Selenium doesn't have a special features to donload files. Normally, you can download files using <b>click</b> method. You need to wait the finish of the donwloading using <a href="https://en.perlzemi.com/blog/20170522149546.html">sleep</a> method.
</p>
<pre>
# Donwload files
$download_button-&gt;click;
sleep 3;
</pre>
<p>
  <b>Examples:</b>
</p>
<pre>
# Get the download button
my $download_buttons = $driver-&gt;find_elements('button');
my $download_button;
for my $download_button (@$download_buttons) {
  my $download_button_text = $download_button-&gt;get_text;
  
  if ($download_button_text =~ /^\s*Download\s*$/) {
    $download_button = $download_button;
    last;
  }
}

# Donwload the file
if ($download_button) {
  $download_button-&gt;click;
  sleep 3;
}
</pre>


  </div>
  <div class="bottom">
    <h3>Related Informatrion</h3>

<div style="margin:10px 10px;"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4525414114581084"
     crossorigin="anonymous"></script>
<ins class="adsbygoogle"
     style="display:block"
     data-ad-format="autorelaxed"
     data-ad-client="ca-pub-4525414114581084"
     data-ad-slot="9163995495"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>

  </div>
</div>

        </div>
        <div class="side">
          <div style="margin-bottom:30px">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4525414114581084"
     crossorigin="anonymous"></script>
<!-- ディスプレイ縦長 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4525414114581084"
     data-ad-slot="4544919209"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>

<div class="side_list">
  <div class="side_list_body">
    <ul>
      <li>
        <div class="side_list_image">
          <a rel="nofollow" href="/list.html">New Articles</a><br>
          <a rel="nofollow" href="https://twitter.com/perlzemien">Updated Articles</a>
        </div>
      </li>
    </ul>
  </div>
</div>

        </div>
      </div>
      <div class="footer">
        <div class="footer-services">
  <ul>
    <li><a rel="nofollow" href="/list.html">News</a></li>
    <li><a rel="nofollow" href="https://perlclub.net/en">Free Online Courses</a></li>
    <li><a rel="nofollow" href="https://twitter.com/perlzemien">Twitter</a>
  </ul>
</div>

<div class="perlri_link">
  <a rel="nofollow" href="https://perlclub.net/en">Perl Club</a>
</div>

      </div>
    </div>
  </body>
</html>
